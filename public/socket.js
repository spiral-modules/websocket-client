/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./lib/index.ts");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./lib/callbackRegistry.ts":
/*!*********************************!*\
  !*** ./lib/callbackRegistry.ts ***!
  \*********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return CallbackRegistry; });\nfunction prefix(name) {\n    return `sf:${name}`;\n}\nclass CallbackRegistry {\n    constructor() {\n        this.callbacks = {};\n    }\n    get(name) {\n        return this.callbacks[prefix(name)];\n    }\n    add(name, callback, channel) {\n        const prefixedEventName = prefix(name);\n        this.callbacks[prefixedEventName] = this.callbacks[prefixedEventName] || [];\n        this.callbacks[prefixedEventName].push({\n            fn: callback,\n            channel: channel || null,\n        });\n    }\n    remove(name, callback, channel) {\n        if (!name && !callback && !channel) {\n            this.callbacks = {};\n            return;\n        }\n        const names = name ? [prefix(name)] : Object.keys(this.callbacks);\n        if (callback || channel) {\n            this.removeCallback(names, callback, channel);\n        }\n        else {\n            this.removeAllCallbacks(names);\n        }\n    }\n    removeCallback(names, callback, channel) {\n        names.forEach((name) => {\n            const callbacks = this.callbacks[name] || [];\n            this.callbacks[name] = callbacks.filter((existedCallback) => {\n                const isEqualCallback = callback && callback === existedCallback.fn;\n                const isEqualChannel = channel && channel === existedCallback.channel;\n                return !isEqualCallback && !isEqualChannel;\n            });\n            if (this.callbacks[name].length === 0) {\n                delete this.callbacks[name];\n            }\n        });\n    }\n    removeAllCallbacks(names) {\n        names.forEach((name) => {\n            delete this.callbacks[name];\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9saWIvY2FsbGJhY2tSZWdpc3RyeS50cz8zMDQyIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQVNBO0FBQUE7QUFBQSxTQUFTLE1BQU0sQ0FBQyxJQUFZO0lBQzFCLE9BQU8sTUFBTSxJQUFJLEVBQUUsQ0FBQztBQUN0QixDQUFDO0FBRWMsTUFBTSxnQkFBZ0I7SUFHbkM7UUFDRSxJQUFJLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQztJQUN0QixDQUFDO0lBRUQsR0FBRyxDQUFDLElBQWE7UUFDZixPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDdEMsQ0FBQztJQUVELEdBQUcsQ0FBQyxJQUFhLEVBQUUsUUFBbUIsRUFBRSxPQUFnQjtRQUN0RCxNQUFNLGlCQUFpQixHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUV2QyxJQUFJLENBQUMsU0FBUyxDQUFDLGlCQUFpQixDQUFDLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUM1RSxJQUFJLENBQUMsU0FBUyxDQUFDLGlCQUFpQixDQUFDLENBQUMsSUFBSSxDQUFDO1lBQ3JDLEVBQUUsRUFBRSxRQUFRO1lBQ1osT0FBTyxFQUFFLE9BQU8sSUFBSSxJQUFJO1NBQ3pCLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxNQUFNLENBQUMsSUFBYSxFQUFFLFFBQW1CLEVBQUUsT0FBZ0I7UUFDekQsSUFBSSxDQUFDLElBQUksSUFBSSxDQUFDLFFBQVEsSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNsQyxJQUFJLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQztZQUNwQixPQUFPO1NBQ1I7UUFFRCxNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBRWxFLElBQUksUUFBUSxJQUFJLE9BQU8sRUFBRTtZQUN2QixJQUFJLENBQUMsY0FBYyxDQUFDLEtBQUssRUFBRSxRQUFRLEVBQUUsT0FBTyxDQUFDLENBQUM7U0FDL0M7YUFBTTtZQUNMLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUNoQztJQUNILENBQUM7SUFFTyxjQUFjLENBQUMsS0FBZ0IsRUFBRSxRQUFvQixFQUFFLE9BQWlCO1FBQzlFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRTtZQUNyQixNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUU3QyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxHQUFHLFNBQVMsQ0FBQyxNQUFNLENBQ3JDLENBQUMsZUFBMEIsRUFBRSxFQUFFO2dCQUM3QixNQUFNLGVBQWUsR0FBRyxRQUFRLElBQUksUUFBUSxLQUFLLGVBQWUsQ0FBQyxFQUFFLENBQUM7Z0JBQ3BFLE1BQU0sY0FBYyxHQUFHLE9BQU8sSUFBSSxPQUFPLEtBQUssZUFBZSxDQUFDLE9BQU8sQ0FBQztnQkFFdEUsT0FBTyxDQUFDLGVBQWUsSUFBSSxDQUFDLGNBQWMsQ0FBQztZQUM3QyxDQUFDLENBQ0YsQ0FBQztZQUNGLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO2dCQUNyQyxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDN0I7UUFDSCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFTyxrQkFBa0IsQ0FBQyxLQUFnQjtRQUN6QyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUU7WUFDckIsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzlCLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztDQUNGIiwiZmlsZSI6Ii4vbGliL2NhbGxiYWNrUmVnaXN0cnkudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbnRlcmZhY2UgSUNhbGxiYWNrIHtcbiAgZm46IEZ1bmN0aW9uO1xuICBjaGFubmVsOiBzdHJpbmcgfCBudWxsO1xufVxuXG5pbnRlcmZhY2UgSUNhbGxiYWNrVGFibGUge1xuICBbaW5kZXg6IHN0cmluZ106IElDYWxsYmFja1tdO1xufVxuXG5mdW5jdGlvbiBwcmVmaXgobmFtZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgcmV0dXJuIGBzZjoke25hbWV9YDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FsbGJhY2tSZWdpc3RyeSB7XG4gIGNhbGxiYWNrczogSUNhbGxiYWNrVGFibGU7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5jYWxsYmFja3MgPSB7fTtcbiAgfVxuXG4gIGdldChuYW1lIDogc3RyaW5nKSA6IElDYWxsYmFja1tdIHtcbiAgICByZXR1cm4gdGhpcy5jYWxsYmFja3NbcHJlZml4KG5hbWUpXTtcbiAgfVxuXG4gIGFkZChuYW1lIDogc3RyaW5nLCBjYWxsYmFjayA6IEZ1bmN0aW9uLCBjaGFubmVsPzogc3RyaW5nKSB7XG4gICAgY29uc3QgcHJlZml4ZWRFdmVudE5hbWUgPSBwcmVmaXgobmFtZSk7XG5cbiAgICB0aGlzLmNhbGxiYWNrc1twcmVmaXhlZEV2ZW50TmFtZV0gPSB0aGlzLmNhbGxiYWNrc1twcmVmaXhlZEV2ZW50TmFtZV0gfHwgW107XG4gICAgdGhpcy5jYWxsYmFja3NbcHJlZml4ZWRFdmVudE5hbWVdLnB1c2goe1xuICAgICAgZm46IGNhbGxiYWNrLFxuICAgICAgY2hhbm5lbDogY2hhbm5lbCB8fCBudWxsLFxuICAgIH0pO1xuICB9XG5cbiAgcmVtb3ZlKG5hbWU/OiBzdHJpbmcsIGNhbGxiYWNrPzogRnVuY3Rpb24sIGNoYW5uZWw/OiBzdHJpbmcpIHtcbiAgICBpZiAoIW5hbWUgJiYgIWNhbGxiYWNrICYmICFjaGFubmVsKSB7XG4gICAgICB0aGlzLmNhbGxiYWNrcyA9IHt9O1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IG5hbWVzID0gbmFtZSA/IFtwcmVmaXgobmFtZSldIDogT2JqZWN0LmtleXModGhpcy5jYWxsYmFja3MpO1xuXG4gICAgaWYgKGNhbGxiYWNrIHx8IGNoYW5uZWwpIHtcbiAgICAgIHRoaXMucmVtb3ZlQ2FsbGJhY2sobmFtZXMsIGNhbGxiYWNrLCBjaGFubmVsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5yZW1vdmVBbGxDYWxsYmFja3MobmFtZXMpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgcmVtb3ZlQ2FsbGJhY2sobmFtZXMgOiBzdHJpbmdbXSwgY2FsbGJhY2s/IDogRnVuY3Rpb24sIGNoYW5uZWw/IDogc3RyaW5nKSB7XG4gICAgbmFtZXMuZm9yRWFjaCgobmFtZSkgPT4ge1xuICAgICAgY29uc3QgY2FsbGJhY2tzID0gdGhpcy5jYWxsYmFja3NbbmFtZV0gfHwgW107XG5cbiAgICAgIHRoaXMuY2FsbGJhY2tzW25hbWVdID0gY2FsbGJhY2tzLmZpbHRlcihcbiAgICAgICAgKGV4aXN0ZWRDYWxsYmFjazogSUNhbGxiYWNrKSA9PiB7XG4gICAgICAgICAgY29uc3QgaXNFcXVhbENhbGxiYWNrID0gY2FsbGJhY2sgJiYgY2FsbGJhY2sgPT09IGV4aXN0ZWRDYWxsYmFjay5mbjtcbiAgICAgICAgICBjb25zdCBpc0VxdWFsQ2hhbm5lbCA9IGNoYW5uZWwgJiYgY2hhbm5lbCA9PT0gZXhpc3RlZENhbGxiYWNrLmNoYW5uZWw7XG5cbiAgICAgICAgICByZXR1cm4gIWlzRXF1YWxDYWxsYmFjayAmJiAhaXNFcXVhbENoYW5uZWw7XG4gICAgICAgIH0sXG4gICAgICApO1xuICAgICAgaWYgKHRoaXMuY2FsbGJhY2tzW25hbWVdLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBkZWxldGUgdGhpcy5jYWxsYmFja3NbbmFtZV07XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIHJlbW92ZUFsbENhbGxiYWNrcyhuYW1lcyA6IHN0cmluZ1tdKSB7XG4gICAgbmFtZXMuZm9yRWFjaCgobmFtZSkgPT4ge1xuICAgICAgZGVsZXRlIHRoaXMuY2FsbGJhY2tzW25hbWVdO1xuICAgIH0pO1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./lib/callbackRegistry.ts\n");

/***/ }),

/***/ "./lib/channel.ts":
/*!************************!*\
  !*** ./lib/channel.ts ***!
  \************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Channel; });\n/* harmony import */ var _eventsDispatcher__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./eventsDispatcher */ \"./lib/eventsDispatcher.ts\");\n\nclass Channel extends _eventsDispatcher__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\n    constructor(name, socket) {\n        super();\n        this.name = name;\n        this.socket = socket;\n        this.subscribed = false;\n        this.subscriptionCancelled = false;\n    }\n    trigger(event, data) {\n        if (!this.subscribed) {\n            console.warn('Client event triggered before channel \\'subscription_succeeded\\' event');\n        }\n        return this.socket.sendEvent(event, data, this.name);\n    }\n    disconnect() {\n        this.subscribed = false;\n    }\n    join() {\n        if (this.subscribed)\n            return;\n        this.subscriptionCancelled = false;\n        this.subscribed = true;\n        this.socket.joinChannel(this.name);\n    }\n    subscribe(eventName, data) {\n        this.socket.subscribe(eventName, data, this.name);\n    }\n    unsubscribe(eventName, data) {\n        this.socket.unsubscribe(eventName, data, this.name);\n    }\n    leaveChannel() {\n        this.subscribed = false;\n        this.socket.leaveChannel(this.name);\n    }\n    cancelSubscription() {\n        this.subscriptionCancelled = true;\n    }\n    reinstateSubscription() {\n        this.subscriptionCancelled = false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9saWIvY2hhbm5lbC50cz9iZGY4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFrRDtBQUduQyxNQUFNLE9BQVEsU0FBUSx5REFBZ0I7SUFTbkQsWUFBWSxJQUFhLEVBQUUsTUFBZ0I7UUFDekMsS0FBSyxFQUFFLENBQUM7UUFFUixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztRQUNqQixJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztRQUNyQixJQUFJLENBQUMsVUFBVSxHQUFHLEtBQUssQ0FBQztRQUN4QixJQUFJLENBQUMscUJBQXFCLEdBQUcsS0FBSyxDQUFDO0lBQ3JDLENBQUM7SUFFRCxPQUFPLENBQUMsS0FBYyxFQUFFLElBQVU7UUFDaEMsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUU7WUFDcEIsT0FBTyxDQUFDLElBQUksQ0FBQyx3RUFBd0UsQ0FBQyxDQUFDO1NBQ3hGO1FBQ0QsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxLQUFLLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUN2RCxDQUFDO0lBRUQsVUFBVTtRQUNSLElBQUksQ0FBQyxVQUFVLEdBQUcsS0FBSyxDQUFDO0lBQzFCLENBQUM7SUFFRCxJQUFJO1FBQ0YsSUFBSSxJQUFJLENBQUMsVUFBVTtZQUFFLE9BQU87UUFDNUIsSUFBSSxDQUFDLHFCQUFxQixHQUFHLEtBQUssQ0FBQztRQUNuQyxJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQztRQUN2QixJQUFJLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDckMsQ0FBQztJQUVELFNBQVMsQ0FBQyxTQUFpQixFQUFFLElBQVM7UUFDcEMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsU0FBUyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDcEQsQ0FBQztJQUVELFdBQVcsQ0FBQyxTQUFpQixFQUFFLElBQVM7UUFDdEMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsU0FBUyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDdEQsQ0FBQztJQUVELFlBQVk7UUFDVixJQUFJLENBQUMsVUFBVSxHQUFHLEtBQUssQ0FBQztRQUN4QixJQUFJLENBQUMsTUFBTSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDdEMsQ0FBQztJQUVELGtCQUFrQjtRQUNoQixJQUFJLENBQUMscUJBQXFCLEdBQUcsSUFBSSxDQUFDO0lBQ3BDLENBQUM7SUFFRCxxQkFBcUI7UUFDbkIsSUFBSSxDQUFDLHFCQUFxQixHQUFHLEtBQUssQ0FBQztJQUNyQyxDQUFDO0NBQ0YiLCJmaWxlIjoiLi9saWIvY2hhbm5lbC50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBFdmVudHNEaXNwYXRjaGVyIGZyb20gJy4vZXZlbnRzRGlzcGF0Y2hlcic7XG5pbXBvcnQgeyBTRlNvY2tldCB9IGZyb20gJy4vc2ZTb2NrZXQnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDaGFubmVsIGV4dGVuZHMgRXZlbnRzRGlzcGF0Y2hlciB7XG4gIG5hbWU6IHN0cmluZztcblxuICBzb2NrZXQ6IFNGU29ja2V0O1xuXG4gIHN1YnNjcmliZWQ6IGJvb2xlYW47XG5cbiAgc3Vic2NyaXB0aW9uQ2FuY2VsbGVkOiBib29sZWFuO1xuXG4gIGNvbnN0cnVjdG9yKG5hbWUgOiBzdHJpbmcsIHNvY2tldDogU0ZTb2NrZXQpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICB0aGlzLnNvY2tldCA9IHNvY2tldDtcbiAgICB0aGlzLnN1YnNjcmliZWQgPSBmYWxzZTtcbiAgICB0aGlzLnN1YnNjcmlwdGlvbkNhbmNlbGxlZCA9IGZhbHNlO1xuICB9XG5cbiAgdHJpZ2dlcihldmVudCA6IHN0cmluZywgZGF0YSA6IGFueSkgeyAvLyBUT0RPXG4gICAgaWYgKCF0aGlzLnN1YnNjcmliZWQpIHtcbiAgICAgIGNvbnNvbGUud2FybignQ2xpZW50IGV2ZW50IHRyaWdnZXJlZCBiZWZvcmUgY2hhbm5lbCBcXCdzdWJzY3JpcHRpb25fc3VjY2VlZGVkXFwnIGV2ZW50Jyk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy5zb2NrZXQuc2VuZEV2ZW50KGV2ZW50LCBkYXRhLCB0aGlzLm5hbWUpO1xuICB9XG5cbiAgZGlzY29ubmVjdCgpIHtcbiAgICB0aGlzLnN1YnNjcmliZWQgPSBmYWxzZTtcbiAgfVxuXG4gIGpvaW4oKSB7XG4gICAgaWYgKHRoaXMuc3Vic2NyaWJlZCkgcmV0dXJuO1xuICAgIHRoaXMuc3Vic2NyaXB0aW9uQ2FuY2VsbGVkID0gZmFsc2U7XG4gICAgdGhpcy5zdWJzY3JpYmVkID0gdHJ1ZTtcbiAgICB0aGlzLnNvY2tldC5qb2luQ2hhbm5lbCh0aGlzLm5hbWUpO1xuICB9XG5cbiAgc3Vic2NyaWJlKGV2ZW50TmFtZTogc3RyaW5nLCBkYXRhOiBhbnkpIHsgLy8gVE9ET1xuICAgIHRoaXMuc29ja2V0LnN1YnNjcmliZShldmVudE5hbWUsIGRhdGEsIHRoaXMubmFtZSk7XG4gIH1cblxuICB1bnN1YnNjcmliZShldmVudE5hbWU6IHN0cmluZywgZGF0YTogYW55KSB7IC8vIFRPRE9cbiAgICB0aGlzLnNvY2tldC51bnN1YnNjcmliZShldmVudE5hbWUsIGRhdGEsIHRoaXMubmFtZSk7XG4gIH1cblxuICBsZWF2ZUNoYW5uZWwoKSB7XG4gICAgdGhpcy5zdWJzY3JpYmVkID0gZmFsc2U7XG4gICAgdGhpcy5zb2NrZXQubGVhdmVDaGFubmVsKHRoaXMubmFtZSk7XG4gIH1cblxuICBjYW5jZWxTdWJzY3JpcHRpb24oKSB7XG4gICAgdGhpcy5zdWJzY3JpcHRpb25DYW5jZWxsZWQgPSB0cnVlO1xuICB9XG5cbiAgcmVpbnN0YXRlU3Vic2NyaXB0aW9uKCkge1xuICAgIHRoaXMuc3Vic2NyaXB0aW9uQ2FuY2VsbGVkID0gZmFsc2U7XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./lib/channel.ts\n");

/***/ }),

/***/ "./lib/connection.ts":
/*!***************************!*\
  !*** ./lib/connection.ts ***!
  \***************************/
/*! exports provided: decodeMessage, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"decodeMessage\", function() { return decodeMessage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Connection; });\n/* harmony import */ var _eventsDispatcher__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./eventsDispatcher */ \"./lib/eventsDispatcher.ts\");\n\nconst systemSymbols = ['@'];\nconst decodeMessage = (messageEvent) => {\n    if (messageEvent) {\n        const messageData = JSON.parse(messageEvent);\n        const calcChannelName = (topic) => {\n            let resultTopic = topic;\n            systemSymbols.forEach((symbol) => {\n                if (topic && topic[0] === symbol) {\n                    resultTopic = '';\n                }\n            });\n            return String(resultTopic);\n        };\n        return {\n            type: 'sfSocket:message',\n            error: null,\n            data: messageData.payload || null,\n            context: {\n                ...(messageData.topic ? { channel: calcChannelName(messageData.topic) } : {}),\n            },\n        };\n    }\n    return {\n        type: 'MessageParseError',\n        error: `messageEvent: ${messageEvent} not contains data property`,\n        data: null,\n    };\n};\nconst encodeMessage = (event) => {\n    const sfEvent = {\n        cmd: event.type,\n        args: event.data,\n    };\n    return JSON.stringify(sfEvent);\n};\nconst prepareCloseAction = (closeEvent) => {\n    if (!closeEvent.context || !closeEvent.context.code) {\n        console.error('socket event do not contain close code');\n        return {\n            ...closeEvent,\n            error: 'connection refused',\n        };\n    }\n    if (closeEvent.context.code < 4000) {\n        if (closeEvent.context.code >= 1002 && closeEvent.context.code <= 1004) {\n            return {\n                ...closeEvent,\n                error: 'socket is unavailable',\n            };\n        }\n    }\n    return closeEvent;\n};\nclass Connection extends _eventsDispatcher__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\n    constructor(id, transport) {\n        super();\n        this.id = id;\n        this.transport = transport;\n        this.bindListeners();\n    }\n    send(data) {\n        if (!this.transport)\n            return false;\n        return this.transport.send(data);\n    }\n    sendEvent(name, data, channel) {\n        const event = {\n            type: name,\n            data,\n            error: null,\n        };\n        if (channel) {\n            event.context = { channel };\n        }\n        return this.send(encodeMessage(event));\n    }\n    close() {\n        if (this.transport) {\n            this.transport.close();\n        }\n    }\n    bindListeners() {\n        const unbindListeners = (listeners) => {\n            if (!this.transport)\n                return;\n            this.transport.unbind('message', listeners.message);\n            this.transport.unbind('error', listeners.error);\n            this.transport.unbind('closed', listeners.closed);\n        };\n        const listeners = {\n            message: (messageEvent) => {\n                let sfSocketEvent = null;\n                try {\n                    sfSocketEvent = decodeMessage(messageEvent.data);\n                }\n                catch (e) {\n                    this.emit('error', {\n                        type: 'MessageParseError',\n                        error: e,\n                        data: typeof messageEvent === 'string' ? messageEvent : JSON.stringify(messageEvent),\n                    });\n                }\n                if (sfSocketEvent) {\n                    if (sfSocketEvent.type === 'sfSocket:error') {\n                        this.emit('error', {\n                            type: 'sfSocket:error',\n                            data: sfSocketEvent.data,\n                            error: null,\n                        });\n                    }\n                    else {\n                        this.emit('message', sfSocketEvent);\n                    }\n                }\n            },\n            error: (error) => {\n                this.emit('error', {\n                    type: 'sfSocket:error',\n                    error,\n                    data: null,\n                });\n            },\n            closed: (closeEvent) => {\n                unbindListeners(listeners);\n                if (closeEvent && closeEvent.context && closeEvent.context.code) {\n                    this.handleCloseEvent(closeEvent);\n                }\n                this.transport = null;\n                this.emit('closed');\n            },\n        };\n        if (!this.transport)\n            return;\n        this.transport.bind('message', listeners.message);\n        this.transport.bind('error', listeners.error);\n        this.transport.bind('closed', listeners.closed);\n    }\n    handleCloseEvent(closeEvent) {\n        const action = prepareCloseAction(closeEvent);\n        if (action.type === 'sfSocket:closed') {\n            this.emit('close', action);\n        }\n        else {\n            this.emit('error', action);\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9saWIvY29ubmVjdGlvbi50cz80NTAzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQWtEO0FBSWxELE1BQU0sYUFBYSxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7QUFFckIsTUFBTSxhQUFhLEdBQUcsQ0FBQyxZQUFxQixFQUFtQixFQUFFO0lBQ3RFLElBQUksWUFBWSxFQUFFO1FBQ2hCLE1BQU0sV0FBVyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUM7UUFFN0MsTUFBTSxlQUFlLEdBQUcsQ0FBQyxLQUFhLEVBQUUsRUFBRTtZQUN4QyxJQUFJLFdBQVcsR0FBRyxLQUFLLENBQUM7WUFFeEIsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDLE1BQU0sRUFBRSxFQUFFO2dCQUMvQixJQUFJLEtBQUssSUFBSSxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssTUFBTSxFQUFFO29CQUNoQyxXQUFXLEdBQUcsRUFBRSxDQUFDO2lCQUNsQjtZQUNILENBQUMsQ0FBQyxDQUFDO1lBRUgsT0FBTyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDN0IsQ0FBQyxDQUFDO1FBRUYsT0FBTztZQUNMLElBQUksRUFBRSxrQkFBa0I7WUFDeEIsS0FBSyxFQUFFLElBQUk7WUFDWCxJQUFJLEVBQUUsV0FBVyxDQUFDLE9BQU8sSUFBSSxJQUFJO1lBQ2pDLE9BQU8sRUFBRTtnQkFDUCxHQUFHLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRSxPQUFPLEVBQUUsZUFBZSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7YUFDOUU7U0FDRixDQUFDO0tBQ0g7SUFFRCxPQUFPO1FBQ0wsSUFBSSxFQUFFLG1CQUFtQjtRQUN6QixLQUFLLEVBQUUsaUJBQWlCLFlBQVksNkJBQTZCO1FBQ2pFLElBQUksRUFBRSxJQUFJO0tBQ1gsQ0FB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QUNuQztnQkFFRCxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQztnQkFDdEIsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUN0QixDQUFDO1NBQ0YsQ0FBQztRQUVGLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUztZQUFFLE9BQU87UUFDNUIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNsRCxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzlDLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDbEQsQ0FBQztJQUVPLGdCQUFnQixDQUFDLFVBQTJCO1FBQ2xELE1BQU0sTUFBTSxHQUFHLGtCQUFrQixDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBRTlDLElBQUksTUFBTSxDQUFDLElBQUksS0FBSyxpQkFBaUIsRUFBRTtZQUNyQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxNQUFNLENBQUMsQ0FBQztTQUM1QjthQUFNO1lBQ0wsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsTUFBTSxDQUFDLENBQUM7U0FDNUI7SUFDSCxDQUFDO0NBQ0YiLCJmaWxlIjoiLi9saWIvY29ubmVjdGlvbi50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBFdmVudHNEaXNwYXRjaGVyIGZyb20gJy4vZXZlbnRzRGlzcGF0Y2hlcic7XG5pbXBvcnQgeyBJU0ZTb2NrZXRFdmVudCB9IGZyb20gJy4vc2ZTb2NrZXQnO1xuaW1wb3J0IFRyYW5zcG9ydENvbm5lY3Rpb24gZnJvbSAnLi90cmFuc3BvcnRDb25uZWN0aW9uJztcblxuY29uc3Qgc3lzdGVtU3ltYm9scyA9IFsnQCddO1xuXG5leHBvcnQgY29uc3QgZGVjb2RlTWVzc2FnZSA9IChtZXNzYWdlRXZlbnQgOiBzdHJpbmcpIDogSVNGU29ja2V0RXZlbnQgPT4ge1xuICBpZiAobWVzc2FnZUV2ZW50KSB7XG4gICAgY29uc3QgbWVzc2FnZURhdGEgPSBKU09OLnBhcnNlKG1lc3NhZ2VFdmVudCk7XG5cbiAgICBjb25zdCBjYWxjQ2hhbm5lbE5hbWUgPSAodG9waWM6IHN0cmluZykgPT4ge1xuICAgICAgbGV0IHJlc3VsdFRvcGljID0gdG9waWM7XG5cbiAgICAgIHN5c3RlbVN5bWJvbHMuZm9yRWFjaCgoc3ltYm9sKSA9PiB7XG4gICAgICAgIGlmICh0b3BpYyAmJiB0b3BpY1swXSA9PT0gc3ltYm9sKSB7XG4gICAgICAgICAgcmVzdWx0VG9waWMgPSAnJztcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBTdHJpbmcocmVzdWx0VG9waWMpO1xuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ3NmU29ja2V0Om1lc3NhZ2UnLFxuICAgICAgZXJyb3I6IG51bGwsXG4gICAgICBkYXRhOiBtZXNzYWdlRGF0YS5wYXlsb2FkIHx8IG51bGwsXG4gICAgICBjb250ZXh0OiB7XG4gICAgICAgIC4uLihtZXNzYWdlRGF0YS50b3BpYyA/IHsgY2hhbm5lbDogY2FsY0NoYW5uZWxOYW1lKG1lc3NhZ2VEYXRhLnRvcGljKSB9IDoge30pLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnTWVzc2FnZVBhcnNlRXJyb3InLFxuICAgIGVycm9yOiBgbWVzc2FnZUV2ZW50OiAke21lc3NhZ2VFdmVudH0gbm90IGNvbnRhaW5zIGRhdGEgcHJvcGVydHlgLFxuICAgIGRhdGE6IG51bGwsXG4gIH07XG59O1xuXG5jb25zdCBlbmNvZGVNZXNzYWdlID0gKGV2ZW50IDogSVNGU29ja2V0RXZlbnQpIDogc3RyaW5nID0+IHtcbiAgY29uc3Qgc2ZFdmVudCA9IHtcbiAgICBjbWQ6IGV2ZW50LnR5cGUsXG4gICAgYXJnczogZXZlbnQuZGF0YSxcbiAgfTtcblxuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoc2ZFdmVudCk7XG59O1xuXG4vKipcbiAqIFNlZTpcbiAqIDEuIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViU29ja2V0cy9XZWJTb2NrZXRzX3JlZmVyZW5jZS9DbG9zZUV2ZW50XG4gKi9cbmNvbnN0IHByZXBhcmVDbG9zZUFjdGlvbiA9IChjbG9zZUV2ZW50OiBJU0ZTb2NrZXRFdmVudCkgOiBJU0ZTb2NrZXRFdmVudCA9PiB7XG4gIGlmICghY2xvc2VFdmVudC5jb250ZXh0IHx8ICFjbG9zZUV2ZW50LmNvbnRleHQuY29kZSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ3NvY2tldCBldmVudCBkbyBub3QgY29udGFpbiBjbG9zZSBjb2RlJyk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLmNsb3NlRXZlbnQsXG4gICAgICBlcnJvcjogJ2Nvbm5lY3Rpb24gcmVmdXNlZCcsXG4gICAgfTtcbiAgfVxuXG4gIGlmIChjbG9zZUV2ZW50LmNvbnRleHQuY29kZSA8IDQwMDApIHtcbiAgICAvLyBpZ25vcmUgMTAwMCBDTE9TRV9OT1JNQUwsIDEwMDEgQ0xPU0VfR09JTkdfQVdBWSxcbiAgICAvLyAgICAgICAgMTAwNSBDTE9TRV9OT19TVEFUVVMsIDEwMDYgQ0xPU0VfQUJOT1JNQUxcbiAgICAvLyBpZ25vcmUgMTAwNy4uLjM5OTlcbiAgICAvLyBoYW5kbGUgMTAwMiBDTE9TRV9QUk9UT0NPTF9FUlJPUiwgMTAwMyBDTE9TRV9VTlNVUFBPUlRFRCxcbiAgICAvLyAgICAgICAgMTAwNCBDTE9TRV9UT09fTEFSR0VcbiAgICBpZiAoY2xvc2VFdmVudC5jb250ZXh0LmNvZGUgPj0gMTAwMiAmJiBjbG9zZUV2ZW50LmNvbnRleHQuY29kZSA8PSAxMDA0KSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5jbG9zZUV2ZW50LFxuICAgICAgICBlcnJvcjogJ3NvY2tldCBpcyB1bmF2YWlsYWJsZScsXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBjbG9zZUV2ZW50O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29ubmVjdGlvbiBleHRlbmRzIEV2ZW50c0Rpc3BhdGNoZXIge1xuICBpZDogc3RyaW5nO1xuXG4gIHRyYW5zcG9ydDogVHJhbnNwb3J0Q29ubmVjdGlvbiB8IG51bGw7XG5cbiAgY29uc3RydWN0b3IoaWQgOiBzdHJpbmcsIHRyYW5zcG9ydCA6IFRyYW5zcG9ydENvbm5lY3Rpb24pIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuaWQgPSBpZDtcbiAgICB0aGlzLnRyYW5zcG9ydCA9IHRyYW5zcG9ydDtcbiAgICB0aGlzLmJpbmRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHNlbmQoZGF0YSA6IHN0cmluZykgOiBib29sZWFuIHtcbiAgICBpZiAoIXRoaXMudHJhbnNwb3J0KSByZXR1cm4gZmFsc2U7XG4gICAgcmV0dXJuIHRoaXMudHJhbnNwb3J0LnNlbmQoZGF0YSk7XG4gIH1cblxuICBzZW5kRXZlbnQobmFtZSA6IHN0cmluZywgZGF0YSA6IGFueSwgY2hhbm5lbD86IHN0cmluZykgOiBib29sZWFuIHtcbiAgICBjb25zdCBldmVudDogSVNGU29ja2V0RXZlbnQgPSB7XG4gICAgICB0eXBlOiBuYW1lLFxuICAgICAgZGF0YSxcbiAgICAgIGVycm9yOiBudWxsLFxuICAgIH07XG5cbiAgICBpZiAoY2hhbm5lbCkge1xuICAgICAgZXZlbnQuY29udGV4dCA9IHsgY2hhbm5lbCB9O1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnNlbmQoZW5jb2RlTWVzc2FnZShldmVudCkpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgaWYgKHRoaXMudHJhbnNwb3J0KSB7XG4gICAgICB0aGlzLnRyYW5zcG9ydC5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYmluZExpc3RlbmVycygpIHtcbiAgICBjb25zdCB1bmJpbmRMaXN0ZW5lcnMgPSAobGlzdGVuZXJzOiBhbnkpID0+IHsgLy8gVE9ET1xuICAgICAgaWYgKCF0aGlzLnRyYW5zcG9ydCkgcmV0dXJuO1xuICAgICAgdGhpcy50cmFuc3BvcnQudW5iaW5kKCdtZXNzYWdlJywgbGlzdGVuZXJzLm1lc3NhZ2UpO1xuICAgICAgdGhpcy50cmFuc3BvcnQudW5iaW5kKCdlcnJvcicsIGxpc3RlbmVycy5lcnJvcik7XG4gICAgICB0aGlzLnRyYW5zcG9ydC51bmJpbmQoJ2Nsb3NlZCcsIGxpc3RlbmVycy5jbG9zZWQpO1xuICAgIH07XG5cbiAgICBjb25zdCBsaXN0ZW5lcnMgPSB7XG4gICAgICBtZXNzYWdlOiAobWVzc2FnZUV2ZW50OiBNZXNzYWdlRXZlbnQpID0+IHtcbiAgICAgICAgbGV0IHNmU29ja2V0RXZlbnQgPSBudWxsO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHNmU29ja2V0RXZlbnQgPSBkZWNvZGVNZXNzYWdlKG1lc3NhZ2VFdmVudC5kYXRhKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCB7XG4gICAgICAgICAgICB0eXBlOiAnTWVzc2FnZVBhcnNlRXJyb3InLFxuICAgICAgICAgICAgZXJyb3I6IGUsXG4gICAgICAgICAgICBkYXRhOiB0eXBlb2YgbWVzc2FnZUV2ZW50ID09PSAnc3RyaW5nJyA/IG1lc3NhZ2VFdmVudCA6IEpTT04uc3RyaW5naWZ5KG1lc3NhZ2VFdmVudCksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc2ZTb2NrZXRFdmVudCkge1xuICAgICAgICAgIGlmIChzZlNvY2tldEV2ZW50LnR5cGUgPT09ICdzZlNvY2tldDplcnJvcicpIHtcbiAgICAgICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCB7XG4gICAgICAgICAgICAgIHR5cGU6ICdzZlNvY2tldDplcnJvcicsXG4gICAgICAgICAgICAgIGRhdGE6IHNmU29ja2V0RXZlbnQuZGF0YSxcbiAgICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5lbWl0KCdtZXNzYWdlJywgc2ZTb2NrZXRFdmVudCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZXJyb3I6IChlcnJvcjogc3RyaW5nKSA9PiB7IC8vIFRPRE9cbiAgICAgICAgdGhpcy5lbWl0KCdlcnJvcicsIHtcbiAgICAgICAgICB0eXBlOiAnc2ZTb2NrZXQ6ZXJyb3InLFxuICAgICAgICAgIGVycm9yLFxuICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIGNsb3NlZDogKGNsb3NlRXZlbnQ6IElTRlNvY2tldEV2ZW50KSA9PiB7IC8vIFRPRE9cbiAgICAgICAgdW5iaW5kTGlzdGVuZXJzKGxpc3RlbmVycyk7XG5cbiAgICAgICAgaWYgKGNsb3NlRXZlbnQgJiYgY2xvc2VFdmVudC5jb250ZXh0ICYmIGNsb3NlRXZlbnQuY29udGV4dC5jb2RlKSB7XG4gICAgICAgICAgdGhpcy5oYW5kbGVDbG9zZUV2ZW50KGNsb3NlRXZlbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy50cmFuc3BvcnQgPSBudWxsO1xuICAgICAgICB0aGlzLmVtaXQoJ2Nsb3NlZCcpO1xuICAgICAgfSxcbiAgICB9O1xuXG4gICAgaWYgKCF0aGlzLnRyYW5zcG9ydCkgcmV0dXJuO1xuICAgIHRoaXMudHJhbnNwb3J0LmJpbmQoJ21lc3NhZ2UnLCBsaXN0ZW5lcnMubWVzc2FnZSk7XG4gICAgdGhpcy50cmFuc3BvcnQuYmluZCgnZXJyb3InLCBsaXN0ZW5lcnMuZXJyb3IpO1xuICAgIHRoaXMudHJhbnNwb3J0LmJpbmQoJ2Nsb3NlZCcsIGxpc3RlbmVycy5jbG9zZWQpO1xuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVDbG9zZUV2ZW50KGNsb3NlRXZlbnQgOiBJU0ZTb2NrZXRFdmVudCkge1xuICAgIGNvbnN0IGFjdGlvbiA9IHByZXBhcmVDbG9zZUFjdGlvbihjbG9zZUV2ZW50KTtcblxuICAgIGlmIChhY3Rpb24udHlwZSA9PT0gJ3NmU29ja2V0OmNsb3NlZCcpIHtcbiAgICAgIHRoaXMuZW1pdCgnY2xvc2UnLCBhY3Rpb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmVtaXQoJ2Vycm9yJywgYWN0aW9uKTtcbiAgICB9XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./lib/connection.ts\n");

/***/ }),

/***/ "./lib/connectionManager.ts":
/*!**********************************!*\
  !*** ./lib/connectionManager.ts ***!
  \**********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ConnectionManager; });\n/* harmony import */ var _eventsDispatcher__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./eventsDispatcher */ \"./lib/eventsDispatcher.ts\");\n/* harmony import */ var _transport__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./transport */ \"./lib/transport.ts\");\n\n\nclass ConnectionManager extends _eventsDispatcher__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\n    constructor(options) {\n        super();\n        this.options = options || {};\n        this.state = 'initialized';\n        this.connection = null;\n        this.usingTLS = Boolean(options.useTLS);\n        this.errorCallbacks = this.buildErrorCallbacks();\n        this.connectionCallbacks = this.buildConnectionCallbacks(this.errorCallbacks);\n        this.transport = new _transport__WEBPACK_IMPORTED_MODULE_1__[\"default\"]('ws', options);\n        this.runner = null;\n        this.unavailableTimer = 0;\n        this.retryTimer = 0;\n    }\n    connect() {\n        if (this.connection || this.runner) {\n            return;\n        }\n        this.updateState('connecting');\n        this.startConnecting();\n        this.setUnavailableTimer();\n    }\n    send(data) {\n        if (this.connection) {\n            return this.connection.send(data);\n        }\n        return false;\n    }\n    sendEvent(name, data, channel) {\n        if (this.connection) {\n            return this.connection.sendEvent(name, data, channel);\n        }\n        return false;\n    }\n    disconnect() {\n        this.disconnectInternally();\n        this.updateState('disconnected');\n    }\n    startConnecting() {\n        const callback = (error, connection) => {\n            if (error) {\n                this.runner = this.transport.connect(callback);\n            }\n            else {\n                this.abortConnecting();\n                this.clearUnavailableTimer();\n                this.setConnection(connection);\n                this.updateState('connected');\n            }\n        };\n        this.runner = this.transport.connect(callback);\n    }\n    abortConnecting() {\n        if (this.runner) {\n            this.runner.abort();\n            this.runner = null;\n        }\n    }\n    disconnectInternally() {\n        this.abortConnecting();\n        this.clearRetryTimer();\n        this.clearUnavailableTimer();\n        if (this.connection) {\n            const connection = this.abandonConnection();\n            if (connection)\n                connection.close();\n        }\n    }\n    retryIn(delay) {\n        if (delay > 0) {\n            this.emit('connecting', {\n                type: 'sfSocket:connecting',\n                data: String(Math.round(delay / 1000)),\n                error: null,\n            });\n        }\n        this.retryTimer = setTimeout(() => {\n            this.disconnectInternally();\n            this.connect();\n        }, delay || 0);\n    }\n    clearRetryTimer() {\n        if (this.retryTimer) {\n            if (this.retryTimer) {\n                clearTimeout(this.retryTimer);\n            }\n            this.retryTimer = 0;\n        }\n    }\n    setUnavailableTimer() {\n        this.unavailableTimer = setTimeout(() => {\n            this.updateState('unavailable');\n        }, this.options.unavailableTimeout);\n    }\n    clearUnavailableTimer() {\n        if (this.unavailableTimer) {\n            clearTimeout(this.unavailableTimer);\n        }\n        this.unavailableTimer = 0;\n    }\n    buildConnectionCallbacks(errorCallbacks) {\n        return {\n            ...errorCallbacks,\n            message: (socketEvent) => {\n                this.emit('message', socketEvent);\n            },\n            error: (errorEvent) => {\n                this.emit('error', errorEvent);\n            },\n            closed: (closeEvent) => {\n                this.abandonConnection();\n                if (this.shouldRetry()) {\n                    this.retryIn(1000);\n                }\n                this.emit('closed', closeEvent);\n            },\n        };\n    }\n    buildErrorCallbacks() {\n        const withErrorEmitted = (callback) => (result) => {\n            if (result.error) {\n                this.emit('error', {\n                    type: 'sfSocket:error',\n                    data: null,\n                    error: result.error,\n                });\n            }\n            callback(result);\n        };\n        return {\n            refused: withErrorEmitted(() => {\n                this.disconnect();\n            }),\n            unavailable: withErrorEmitted(() => {\n                this.retryIn(1000);\n            }),\n        };\n    }\n    setConnection(connection) {\n        this.connection = connection;\n        if (!this.connection) {\n            return;\n        }\n        this.connection.bind('message', this.connectionCallbacks.message);\n        this.connection.bind('error', this.connectionCallbacks.error);\n        this.connection.bind('closed', this.connectionCallbacks.closed);\n    }\n    abandonConnection() {\n        if (!this.connection) {\n            return null;\n        }\n        this.connection.unbind('message', this.connectionCallbacks.message);\n        this.connection.unbind('error', this.connectionCallbacks.error);\n        this.connection.unbind('closed', this.connectionCallbacks.closed);\n        const { connection } = this;\n        this.connection = null;\n        return connection;\n    }\n    updateState(newState) {\n        const previousState = this.state;\n        this.state = newState;\n        if (previousState !== newState) {\n            this.emit(newState);\n        }\n    }\n    shouldRetry() {\n        return this.state === 'connecting' || this.state === 'connected';\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9saWIvY29ubmVjdGlvbk1hbmFnZXIudHM/ZGNjYyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFrRDtBQUNXO0FBcUI5QyxNQUFNLGlCQUFrQixTQUFRLHlEQUFnQjtJQXFCN0QsWUFBWSxPQUF5QjtRQUNuQyxLQUFLLEVBQUUsQ0FBQztRQUNSLElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxJQUFJLEVBQUUsQ0FBQztRQUM3QixJQUFJLENBQUMsS0FBSyxHQUFHLGFBQWEsQ0FBQztRQUMzQixJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQztRQUN2QixJQUFJLENBQUMsUUFBUSxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7UUFFeEMsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUMsbUJBQW1CLEVBQUUsQ0FBQztRQUNqRCxJQUFJLENBQUMsbUJBQW1CLEdBQUcsSUFBSSxDQUFDLHdCQUF3QixDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUU5RSxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksa0RBQVMsQ0FDNUIsSUFBSSxFQUNKLE9BQU8sQ0FDUixDQUFDO1FBQ0YsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUM7UUFFbkIsSUFBSSxDQUFDLGdCQUFnQixHQUFHLENBQUMsQ0FBQztRQUMxQixJQUFJLENBQUMsVUFBVSxHQUFHLENBQUMsQ0FBQztJQUN0QixDQUFDO0lBRUQsT0FBTztRQUNMLElBQUksSUFBSSxDQUFDLFVBQVUsSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFO1lBQ2xDLE9BQU87U0FDUjtRQUNELElBQUksQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDL0IsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxDQUFDO0lBQzdCLENBQUM7SUFFRCxJQUFJLENBQUMsSUFBWTtR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LE1BQU0sQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLG1CQUFtQixDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ2hFLElBQUksQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsbUJBQW1CLENBQUMsTUFBTSxDQUFDLENBQUM7UUFFbEUsTUFBTSxFQUFFLFVBQVUsRUFBRSxHQUFHLElBQUksQ0FBQztRQUM1QixJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQztRQUV2QixPQUFPLFVBQVUsQ0FBQztJQUNwQixDQUFDO0lBRU8sV0FBVyxDQUFDLFFBQWlCO1FBQ25DLE1BQU0sYUFBYSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUM7UUFDakMsSUFBSSxDQUFDLEtBQUssR0FBRyxRQUFRLENBQUM7UUFDdEIsSUFBSSxhQUFhLEtBQUssUUFBUSxFQUFFO1lBQzlCLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7U0FDckI7SUFDSCxDQUFDO0lBRU8sV0FBVztRQUNqQixPQUFPLElBQUksQ0FBQyxLQUFLLEtBQUssWUFBWSxJQUFJLElBQUksQ0FBQyxLQUFLLEtBQUssV0FBVyxDQUFDO0lBQ25FLENBQUM7Q0FDRiIsImZpbGUiOiIuL2xpYi9jb25uZWN0aW9uTWFuYWdlci50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBFdmVudHNEaXNwYXRjaGVyIGZyb20gJy4vZXZlbnRzRGlzcGF0Y2hlcic7XG5pbXBvcnQgVHJhbnNwb3J0LCB7IElSdW5uZXIsIElUcmFuc3BvcnQgfSBmcm9tICcuL3RyYW5zcG9ydCc7XG5pbXBvcnQgQ29ubmVjdGlvbiBmcm9tICcuL2Nvbm5lY3Rpb24nO1xuaW1wb3J0IHsgSVNGU29ja2V0Q29uZmlnLCBJU0ZTb2NrZXRFdmVudCB9IGZyb20gJy4vc2ZTb2NrZXQnO1xuXG5pbnRlcmZhY2UgQWN0aW9uIHtcbiAgYWN0aW9uOiBzdHJpbmc7XG4gIGlkPzogc3RyaW5nO1xuICBlcnJvcj86IGFueTsgLy8gVE9ET1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEVycm9yQ2FsbGJhY2tzIHtcbiAgcmVmdXNlZDogKHJlc3VsdDogQWN0aW9uKSA9PiB2b2lkO1xuICB1bmF2YWlsYWJsZTogKHJlc3VsdDogQWN0aW9uKSA9PiB2b2lkO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbm5lY3Rpb25DYWxsYmFja3Mge1xuICBtZXNzYWdlOiAobWVzc2FnZTogYW55KSA9PiB2b2lkOyAvLyBUT0RPXG4gIGVycm9yOiAoZXJyb3I6IGFueSkgPT4gdm9pZDsgLy8gVE9ET1xuICBjbG9zZWQ6IChyZWFzb246IGFueSkgPT4gdm9pZDsgLy8gVE9ET1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb25uZWN0aW9uTWFuYWdlciBleHRlbmRzIEV2ZW50c0Rpc3BhdGNoZXIge1xuICBvcHRpb25zOiBJU0ZTb2NrZXRDb25maWc7XG5cbiAgc3RhdGU6IHN0cmluZztcblxuICBjb25uZWN0aW9uOiBDb25uZWN0aW9uIHwgbnVsbDtcblxuICB1c2luZ1RMUzogYm9vbGVhbjtcblxuICB1bmF2YWlsYWJsZVRpbWVyOiBudW1iZXI7XG5cbiAgcmV0cnlUaW1lcjogbnVtYmVyO1xuXG4gIHRyYW5zcG9ydDogSVRyYW5zcG9ydDtcblxuICBydW5uZXI6IElSdW5uZXIgfCBudWxsO1xuXG4gIGVycm9yQ2FsbGJhY2tzOiBFcnJvckNhbGxiYWNrcztcblxuICBjb25uZWN0aW9uQ2FsbGJhY2tzOiBDb25uZWN0aW9uQ2FsbGJhY2tzO1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMgOiBJU0ZTb2NrZXRDb25maWcpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgdGhpcy5zdGF0ZSA9ICdpbml0aWFsaXplZCc7XG4gICAgdGhpcy5jb25uZWN0aW9uID0gbnVsbDtcbiAgICB0aGlzLnVzaW5nVExTID0gQm9vbGVhbihvcHRpb25zLnVzZVRMUyk7XG5cbiAgICB0aGlzLmVycm9yQ2FsbGJhY2tzID0gdGhpcy5idWlsZEVycm9yQ2FsbGJhY2tzKCk7XG4gICAgdGhpcy5jb25uZWN0aW9uQ2FsbGJhY2tzID0gdGhpcy5idWlsZENvbm5lY3Rpb25DYWxsYmFja3ModGhpcy5lcnJvckNhbGxiYWNrcyk7XG5cbiAgICB0aGlzLnRyYW5zcG9ydCA9IG5ldyBUcmFuc3BvcnQoXG4gICAgICAnd3MnLFxuICAgICAgb3B0aW9ucyxcbiAgICApO1xuICAgIHRoaXMucnVubmVyID0gbnVsbDtcblxuICAgIHRoaXMudW5hdmFpbGFibGVUaW1lciA9IDA7XG4gICAgdGhpcy5yZXRyeVRpbWVyID0gMDtcbiAgfVxuXG4gIGNvbm5lY3QoKSB7XG4gICAgaWYgKHRoaXMuY29ubmVjdGlvbiB8fCB0aGlzLnJ1bm5lcikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnVwZGF0ZVN0YXRlKCdjb25uZWN0aW5nJyk7XG4gICAgdGhpcy5zdGFydENvbm5lY3RpbmcoKTtcbiAgICB0aGlzLnNldFVuYXZhaWxhYmxlVGltZXIoKTtcbiAgfVxuXG4gIHNlbmQoZGF0YTogc3RyaW5nKSB7XG4gICAgaWYgKHRoaXMuY29ubmVjdGlvbikge1xuICAgICAgcmV0dXJuIHRoaXMuY29ubmVjdGlvbi5zZW5kKGRhdGEpO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBzZW5kRXZlbnQobmFtZSA6IHN0cmluZywgZGF0YSA6IHN0cmluZ1tdLCBjaGFubmVsPzogc3RyaW5nKSB7XG4gICAgaWYgKHRoaXMuY29ubmVjdGlvbikge1xuICAgICAgcmV0dXJuIHRoaXMuY29ubmVjdGlvbi5zZW5kRXZlbnQobmFtZSwgZGF0YSwgY2hhbm5lbCk7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGRpc2Nvbm5lY3QoKSB7XG4gICAgdGhpcy5kaXNjb25uZWN0SW50ZXJuYWxseSgpO1xuICAgIHRoaXMudXBkYXRlU3RhdGUoJ2Rpc2Nvbm5lY3RlZCcpO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGFydENvbm5lY3RpbmcoKSB7XG4gICAgY29uc3QgY2FsbGJhY2sgPSAoZXJyb3I6IGFueSwgY29ubmVjdGlvbjogQ29ubmVjdGlvbikgPT4geyAvLyBUT0RPXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgdGhpcy5ydW5uZXIgPSB0aGlzLnRyYW5zcG9ydC5jb25uZWN0KGNhbGxiYWNrKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuYWJvcnRDb25uZWN0aW5nKCk7XG5cbiAgICAgICAgdGhpcy5jbGVhclVuYXZhaWxhYmxlVGltZXIoKTtcbiAgICAgICAgdGhpcy5zZXRDb25uZWN0aW9uKGNvbm5lY3Rpb24pO1xuICAgICAgICB0aGlzLnVwZGF0ZVN0YXRlKCdjb25uZWN0ZWQnKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMucnVubmVyID0gdGhpcy50cmFuc3BvcnQuY29ubmVjdChjYWxsYmFjayk7XG4gIH1cblxuICBwcml2YXRlIGFib3J0Q29ubmVjdGluZygpIHtcbiAgICBpZiAodGhpcy5ydW5uZXIpIHtcbiAgICAgIHRoaXMucnVubmVyLmFib3J0KCk7XG4gICAgICB0aGlzLnJ1bm5lciA9IG51bGw7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBkaXNjb25uZWN0SW50ZXJuYWxseSgpIHtcbiAgICB0aGlzLmFib3J0Q29ubmVjdGluZygpO1xuICAgIHRoaXMuY2xlYXJSZXRyeVRpbWVyKCk7XG4gICAgdGhpcy5jbGVhclVuYXZhaWxhYmxlVGltZXIoKTtcbiAgICBpZiAodGhpcy5jb25uZWN0aW9uKSB7XG4gICAgICBjb25zdCBjb25uZWN0aW9uID0gdGhpcy5hYmFuZG9uQ29ubmVjdGlvbigpO1xuICAgICAgaWYgKGNvbm5lY3Rpb24pIGNvbm5lY3Rpb24uY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHJldHJ5SW4oZGVsYXk6IG51bWJlcikge1xuICAgIGlmIChkZWxheSA+IDApIHtcbiAgICAgIHRoaXMuZW1pdCgnY29ubmVjdGluZycsIHtcbiAgICAgICAgdHlwZTogJ3NmU29ja2V0OmNvbm5lY3RpbmcnLFxuICAgICAgICBkYXRhOiBTdHJpbmcoTWF0aC5yb3VuZChkZWxheSAvIDEwMDApKSxcbiAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5yZXRyeVRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0aGlzLmRpc2Nvbm5lY3RJbnRlcm5hbGx5KCk7XG4gICAgICB0aGlzLmNvbm5lY3QoKTtcbiAgICB9LCBkZWxheSB8fCAwKTtcbiAgfVxuXG4gIHByaXZhdGUgY2xlYXJSZXRyeVRpbWVyKCkge1xuICAgIGlmICh0aGlzLnJldHJ5VGltZXIpIHtcbiAgICAgIGlmICh0aGlzLnJldHJ5VGltZXIpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMucmV0cnlUaW1lcik7XG4gICAgICB9XG4gICAgICB0aGlzLnJldHJ5VGltZXIgPSAwO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc2V0VW5hdmFpbGFibGVUaW1lcigpIHtcbiAgICB0aGlzLnVuYXZhaWxhYmxlVGltZXIgPSBzZXRUaW1lb3V0KFxuICAgICAgKCkgPT4ge1xuICAgICAgICB0aGlzLnVwZGF0ZVN0YXRlKCd1bmF2YWlsYWJsZScpO1xuICAgICAgfSxcbiAgICAgIHRoaXMub3B0aW9ucy51bmF2YWlsYWJsZVRpbWVvdXQsXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgY2xlYXJVbmF2YWlsYWJsZVRpbWVyKCkge1xuICAgIGlmICh0aGlzLnVuYXZhaWxhYmxlVGltZXIpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnVuYXZhaWxhYmxlVGltZXIpO1xuICAgIH1cbiAgICB0aGlzLnVuYXZhaWxhYmxlVGltZXIgPSAwO1xuICB9XG5cbiAgcHJpdmF0ZSBidWlsZENvbm5lY3Rpb25DYWxsYmFja3MoZXJyb3JDYWxsYmFja3M6IEVycm9yQ2FsbGJhY2tzKSA6IENvbm5lY3Rpb25DYWxsYmFja3Mge1xuICAgIHJldHVybiB7XG4gICAgICAuLi5lcnJvckNhbGxiYWNrcyxcbiAgICAgIG1lc3NhZ2U6IChzb2NrZXRFdmVudDogSVNGU29ja2V0RXZlbnQpID0+IHtcbiAgICAgIC8vIGluY2x1ZGVzIHBvbmcgbWVzc2FnZXMgZnJvbSBzZXJ2ZXJcbiAgICAgICAgdGhpcy5lbWl0KCdtZXNzYWdlJywgc29ja2V0RXZlbnQpO1xuICAgICAgfSxcbiAgICAgIGVycm9yOiAoZXJyb3JFdmVudDogSVNGU29ja2V0RXZlbnQpID0+IHtcbiAgICAgIC8vIGp1c3QgZW1pdCBlcnJvciB0byB1c2VyIC0gc29ja2V0IHdpbGwgYWxyZWFkeSBiZSBjbG9zZWQgYnkgYnJvd3NlclxuICAgICAgICB0aGlzLmVtaXQoJ2Vycm9yJywgZXJyb3JFdmVudCk7XG4gICAgICB9LFxuICAgICAgY2xvc2VkOiAoY2xvc2VFdmVudDogSVNGU29ja2V0RXZlbnQpID0+IHtcbiAgICAgICAgdGhpcy5hYmFuZG9uQ29ubmVjdGlvbigpO1xuICAgICAgICBpZiAodGhpcy5zaG91bGRSZXRyeSgpKSB7XG4gICAgICAgICAgdGhpcy5yZXRyeUluKDEwMDApO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZW1pdCgnY2xvc2VkJywgY2xvc2VFdmVudCk7XG4gICAgICB9LFxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIGJ1aWxkRXJyb3JDYWxsYmFja3MoKSA6IEVycm9yQ2FsbGJhY2tzIHtcbiAgICBjb25zdCB3aXRoRXJyb3JFbWl0dGVkID0gKGNhbGxiYWNrOiBGdW5jdGlvbikgPT4gKHJlc3VsdDogQWN0aW9uKSA9PiB7XG4gICAgICBpZiAocmVzdWx0LmVycm9yKSB7XG4gICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCB7XG4gICAgICAgICAgdHlwZTogJ3NmU29ja2V0OmVycm9yJyxcbiAgICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICAgIGVycm9yOiByZXN1bHQuZXJyb3IsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY2FsbGJhY2socmVzdWx0KTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHJlZnVzZWQ6IHdpdGhFcnJvckVtaXR0ZWQoKCkgPT4ge1xuICAgICAgICB0aGlzLmRpc2Nvbm5lY3QoKTtcbiAgICAgIH0pLFxuICAgICAgdW5hdmFpbGFibGU6IHdpdGhFcnJvckVtaXR0ZWQoKCkgPT4ge1xuICAgICAgICB0aGlzLnJldHJ5SW4oMTAwMCk7XG4gICAgICB9KSxcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBzZXRDb25uZWN0aW9uKGNvbm5lY3Rpb246IENvbm5lY3Rpb24gfCBudWxsKSB7XG4gICAgdGhpcy5jb25uZWN0aW9uID0gY29ubmVjdGlvbjtcbiAgICBpZiAoIXRoaXMuY29ubmVjdGlvbikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmNvbm5lY3Rpb24uYmluZCgnbWVzc2FnZScsIHRoaXMuY29ubmVjdGlvbkNhbGxiYWNrcy5tZXNzYWdlKTtcbiAgICB0aGlzLmNvbm5lY3Rpb24uYmluZCgnZXJyb3InLCB0aGlzLmNvbm5lY3Rpb25DYWxsYmFja3MuZXJyb3IpO1xuICAgIHRoaXMuY29ubmVjdGlvbi5iaW5kKCdjbG9zZWQnLCB0aGlzLmNvbm5lY3Rpb25DYWxsYmFja3MuY2xvc2VkKTtcbiAgfVxuXG4gIHByaXZhdGUgYWJhbmRvbkNvbm5lY3Rpb24oKSB7XG4gICAgaWYgKCF0aGlzLmNvbm5lY3Rpb24pIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB0aGlzLmNvbm5lY3Rpb24udW5iaW5kKCdtZXNzYWdlJywgdGhpcy5jb25uZWN0aW9uQ2FsbGJhY2tzLm1lc3NhZ2UpO1xuICAgIHRoaXMuY29ubmVjdGlvbi51bmJpbmQoJ2Vycm9yJywgdGhpcy5jb25uZWN0aW9uQ2FsbGJhY2tzLmVycm9yKTtcbiAgICB0aGlzLmNvbm5lY3Rpb24udW5iaW5kKCdjbG9zZWQnLCB0aGlzLmNvbm5lY3Rpb25DYWxsYmFja3MuY2xvc2VkKTtcblxuICAgIGNvbnN0IHsgY29ubmVjdGlvbiB9ID0gdGhpcztcbiAgICB0aGlzLmNvbm5lY3Rpb24gPSBudWxsO1xuXG4gICAgcmV0dXJuIGNvbm5lY3Rpb247XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZVN0YXRlKG5ld1N0YXRlIDogc3RyaW5nKSB7XG4gICAgY29uc3QgcHJldmlvdXNTdGF0ZSA9IHRoaXMuc3RhdGU7XG4gICAgdGhpcy5zdGF0ZSA9IG5ld1N0YXRlO1xuICAgIGlmIChwcmV2aW91c1N0YXRlICE9PSBuZXdTdGF0ZSkge1xuICAgICAgdGhpcy5lbWl0KG5ld1N0YXRlKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHNob3VsZFJldHJ5KCkgOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZSA9PT0gJ2Nvbm5lY3RpbmcnIHx8IHRoaXMuc3RhdGUgPT09ICdjb25uZWN0ZWQnO1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./lib/connectionManager.ts\n");

/***/ }),

/***/ "./lib/eventsDispatcher.ts":
/*!*********************************!*\
  !*** ./lib/eventsDispatcher.ts ***!
  \*********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return EventsDispatcher; });\n/* harmony import */ var _callbackRegistry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./callbackRegistry */ \"./lib/callbackRegistry.ts\");\n\nclass EventsDispatcher {\n    constructor() {\n        this.callbacks = new _callbackRegistry__WEBPACK_IMPORTED_MODULE_0__[\"default\"]();\n    }\n    bind(eventName, callback, channel) {\n        this.callbacks.add(eventName, callback, channel);\n        return this;\n    }\n    unbind(eventName, callback, channel) {\n        this.callbacks.remove(eventName, callback, channel);\n        return this;\n    }\n    emit(eventName, event) {\n        const callbacks = this.callbacks.get(eventName);\n        const channelEvent = event && event.context\n            ? event.context.channel\n            : null;\n        const hasCallbacks = callbacks && callbacks.length > 0;\n        if (hasCallbacks) {\n            callbacks.forEach((callback) => {\n                const isChannelCallback = callback.channel === channelEvent;\n                const isGlobalCallback = !callback.channel || !channelEvent;\n                if (isGlobalCallback || isChannelCallback) {\n                    callback.fn(event);\n                }\n            });\n        }\n        return this;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9saWIvZXZlbnRzRGlzcGF0Y2hlci50cz80NWM0Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFrRDtBQUluQyxNQUFNLGdCQUFnQjtJQUduQztRQUNFLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSx5REFBZ0IsRUFBRSxDQUFDO0lBQzFDLENBQUM7SUFFRCxJQUFJLENBQUMsU0FBa0IsRUFBRSxRQUFtQixFQUFFLE9BQWdCO1FBQzVELElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxRQUFRLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDakQsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0lBRUQsTUFBTSxDQUFDLFNBQWtCLEVBQUUsUUFBbUIsRUFBRSxPQUFnQjtRQUM5RCxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxTQUFTLEVBQUUsUUFBUSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3BELE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVELElBQUksQ0FBQyxTQUFrQixFQUFFLEtBQXNCO1FBQzdDLE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBRWhELE1BQU0sWUFBWSxHQUE4QixLQUFLLElBQUksS0FBSyxDQUFDLE9BQU87WUFDcEUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTztZQUN2QixDQUFDLENBQUMsSUFBSSxDQUFDO1FBRVQsTUFBTSxZQUFZLEdBQUcsU0FBUyxJQUFJLFNBQVMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO1FBRXZELElBQUksWUFBWSxFQUFFO1lBQ2hCLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxRQUFRLEVBQUUsRUFBRTtnQkFDN0IsTUFBTSxpQkFBaUIsR0FBRyxRQUFRLENBQUMsT0FBTyxLQUFLLFlBQVksQ0FBQztnQkFDNUQsTUFBTSxnQkFBZ0IsR0FBRyxDQUFDLFFBQVEsQ0FBQyxPQUFPLElBQUksQ0FBQyxZQUFZLENBQUM7Z0JBRTVELElBQUksZ0JBQWdCLElBQUksaUJBQWlCLEVBQUU7b0JBQ3pDLFFBQVEsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUM7aUJBQ3BCO1lBQ0gsQ0FBQyxDQUFDLENBQUM7U0FDSjtRQUVELE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztDQUNGIiwiZmlsZSI6Ii4vbGliL2V2ZW50c0Rpc3BhdGNoZXIudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ2FsbGJhY2tSZWdpc3RyeSBmcm9tICcuL2NhbGxiYWNrUmVnaXN0cnknO1xuaW1wb3J0IHsgSVNGU29ja2V0RXZlbnQgfSBmcm9tICcuL3NmU29ja2V0JztcblxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBFdmVudHNEaXNwYXRjaGVyIHtcbiAgY2FsbGJhY2tzOiBDYWxsYmFja1JlZ2lzdHJ5O1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuY2FsbGJhY2tzID0gbmV3IENhbGxiYWNrUmVnaXN0cnkoKTtcbiAgfVxuXG4gIGJpbmQoZXZlbnROYW1lIDogc3RyaW5nLCBjYWxsYmFjayA6IEZ1bmN0aW9uLCBjaGFubmVsPzogc3RyaW5nKSB7XG4gICAgdGhpcy5jYWxsYmFja3MuYWRkKGV2ZW50TmFtZSwgY2FsbGJhY2ssIGNoYW5uZWwpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgdW5iaW5kKGV2ZW50TmFtZSA6IHN0cmluZywgY2FsbGJhY2sgOiBGdW5jdGlvbiwgY2hhbm5lbD86IHN0cmluZykge1xuICAgIHRoaXMuY2FsbGJhY2tzLnJlbW92ZShldmVudE5hbWUsIGNhbGxiYWNrLCBjaGFubmVsKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGVtaXQoZXZlbnROYW1lIDogc3RyaW5nLCBldmVudD86IElTRlNvY2tldEV2ZW50KSA6IEV2ZW50c0Rpc3BhdGNoZXIge1xuICAgIGNvbnN0IGNhbGxiYWNrcyA9IHRoaXMuY2FsbGJhY2tzLmdldChldmVudE5hbWUpO1xuXG4gICAgY29uc3QgY2hhbm5lbEV2ZW50OiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkID0gZXZlbnQgJiYgZXZlbnQuY29udGV4dFxuICAgICAgPyBldmVudC5jb250ZXh0LmNoYW5uZWxcbiAgICAgIDogbnVsbDtcblxuICAgIGNvbnN0IGhhc0NhbGxiYWNrcyA9IGNhbGxiYWNrcyAmJiBjYWxsYmFja3MubGVuZ3RoID4gMDtcblxuICAgIGlmIChoYXNDYWxsYmFja3MpIHtcbiAgICAgIGNhbGxiYWNrcy5mb3JFYWNoKChjYWxsYmFjaykgPT4ge1xuICAgICAgICBjb25zdCBpc0NoYW5uZWxDYWxsYmFjayA9IGNhbGxiYWNrLmNoYW5uZWwgPT09IGNoYW5uZWxFdmVudDtcbiAgICAgICAgY29uc3QgaXNHbG9iYWxDYWxsYmFjayA9ICFjYWxsYmFjay5jaGFubmVsIHx8ICFjaGFubmVsRXZlbnQ7XG5cbiAgICAgICAgaWYgKGlzR2xvYmFsQ2FsbGJhY2sgfHwgaXNDaGFubmVsQ2FsbGJhY2spIHtcbiAgICAgICAgICBjYWxsYmFjay5mbihldmVudCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./lib/eventsDispatcher.ts\n");

/***/ }),

/***/ "./lib/index.ts":
/*!**********************!*\
  !*** ./lib/index.ts ***!
  \**********************/
/*! exports provided: SFSocket, makeSocketOptions, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"makeSocketOptions\", function() { return makeSocketOptions; });\n/* harmony import */ var _sfSocket__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./sfSocket */ \"./lib/sfSocket.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SFSocket\", function() { return _sfSocket__WEBPACK_IMPORTED_MODULE_0__[\"SFSocket\"]; });\n\n\nconst makeSocketOptions = (wsUrl) => {\n    const url = new URL(wsUrl);\n    const urlProtocol = url.protocol ? url.protocol.replace(':', '') : null;\n    if (url.hostname && url.port && urlProtocol) {\n        return {\n            host: url.hostname,\n            port: url.port,\n            path: urlProtocol,\n        };\n    }\n    return null;\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (_sfSocket__WEBPACK_IMPORTED_MODULE_0__[\"SFSocket\"]);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9saWIvaW5kZXgudHM/NGQ4NSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQXNDO0FBRXRDLE1BQU0saUJBQWlCLEdBQUcsQ0FBQyxLQUFhLEVBQUUsRUFBRTtJQUMxQyxNQUFNLEdBQUcsR0FBRyxJQUFJLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUMzQixNQUFNLFdBQVcsR0FBRyxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztJQUV4RSxJQUFJLEdBQUcsQ0FBQyxRQUFRLElBQUksR0FBRyxDQUFDLElBQUksSUFBSSxXQUFXLEVBQUU7UUFDM0MsT0FBTztZQUNMLElBQUksRUFBRSxHQUFHLENBQUMsUUFBUTtZQUNsQixJQUFJLEVBQUUsR0FBRyxDQUFDLElBQUk7WUFDZCxJQUFJLEVBQUUsV0FBVztTQUNsQixDQUFDO0tBQ0g7SUFFRCxPQUFPLElBQUksQ0FBQztBQUNkLENBQUMsQ0FBQztBQUdxQztBQUN4QixpSEFBUSxFQUFDIiwiZmlsZSI6Ii4vbGliL2luZGV4LnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU0ZTb2NrZXQgfSBmcm9tICcuL3NmU29ja2V0JztcblxuY29uc3QgbWFrZVNvY2tldE9wdGlvbnMgPSAod3NVcmw6IHN0cmluZykgPT4ge1xuICBjb25zdCB1cmwgPSBuZXcgVVJMKHdzVXJsKTtcbiAgY29uc3QgdXJsUHJvdG9jb2wgPSB1cmwucHJvdG9jb2wgPyB1cmwucHJvdG9jb2wucmVwbGFjZSgnOicsICcnKSA6IG51bGw7XG5cbiAgaWYgKHVybC5ob3N0bmFtZSAmJiB1cmwucG9ydCAmJiB1cmxQcm90b2NvbCkge1xuICAgIHJldHVybiB7XG4gICAgICBob3N0OiB1cmwuaG9zdG5hbWUsIC8vIGhvc3Q6ICdsb2NhbGhvc3QnLFxuICAgICAgcG9ydDogdXJsLnBvcnQsIC8vIHBvcnQ6ICc4MDgwJyxcbiAgICAgIHBhdGg6IHVybFByb3RvY29sLCAvLyBwYXRoOiAnd3MnLFxuICAgIH07XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn07XG5cblxuZXhwb3J0IHsgU0ZTb2NrZXQsIG1ha2VTb2NrZXRPcHRpb25zIH07XG5leHBvcnQgZGVmYXVsdCBTRlNvY2tldDtcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./lib/index.ts\n");

/***/ }),

/***/ "./lib/sfSocket.ts":
/*!*************************!*\
  !*** ./lib/sfSocket.ts ***!
  \*************************/
/*! exports provided: SFSocket */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SFSocket\", function() { return SFSocket; });\n/* harmony import */ var _channel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./channel */ \"./lib/channel.ts\");\n/* harmony import */ var _eventsDispatcher__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./eventsDispatcher */ \"./lib/eventsDispatcher.ts\");\n/* harmony import */ var _connectionManager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./connectionManager */ \"./lib/connectionManager.ts\");\n\n\n\nconst STORAGE_KEY = 'sfsocket_storage';\nconst CONNECTION_EVENTS = {\n    JOIN: 'join',\n    LEAVE: 'leave',\n};\nconst defaultConfig = {\n    host: '',\n    port: 80,\n    portTLS: 443,\n    path: '',\n    unavailableTimeout: 10000,\n    useTLS: false,\n    useStorage: false,\n};\nclass SFSocket {\n    constructor(options) {\n        if (!options || typeof options !== 'object') {\n            throw new Error('sfSocket options should be an object');\n        }\n        const constructorOptions = options || {};\n        this.config = {\n            ...defaultConfig,\n            ...constructorOptions,\n        };\n        this.channels = {};\n        this.eventsDispatcher = new _eventsDispatcher__WEBPACK_IMPORTED_MODULE_1__[\"default\"]();\n        this.hasStorage = Boolean(this.config.useStorage && window && window.localStorage);\n        this.connection = new _connectionManager__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this.config);\n        this.connection.bind('connected', () => {\n            Object.keys(this.channels).forEach((channelName) => {\n                this.subscribeChannel(channelName);\n            });\n        });\n        this.connection.bind('message', (event) => {\n            this.eventsDispatcher.emit('message', event);\n        });\n        this.connection.bind('connecting', () => {\n            this.channelsDisconnect();\n        });\n        this.connection.bind('disconnected', () => {\n            this.channelsDisconnect();\n        });\n        this.connection.bind('error', (err) => {\n            console.error(err);\n        });\n        SFSocket.instances.push(this);\n        if (SFSocket.isReady) {\n            this.connect();\n        }\n        if (this.hasStorage) {\n            const activeChannels = this.getStorage();\n            if (activeChannels) {\n                activeChannels.forEach((channelName) => {\n                    this.subscribeChannel(channelName);\n                });\n            }\n        }\n    }\n    static ready() {\n        SFSocket.isReady = true;\n        SFSocket.instances.forEach((instance) => {\n            instance.connect();\n        });\n    }\n    connect() {\n        this.connection.connect();\n    }\n    disconnect() {\n        this.connection.disconnect();\n    }\n    sendEvent(eventName, data, channel) {\n        return this.connection.sendEvent(eventName, data, channel);\n    }\n    join(data) {\n        return this.sendEvent(CONNECTION_EVENTS.JOIN, data);\n    }\n    leave(data) {\n        return this.sendEvent(CONNECTION_EVENTS.LEAVE, data);\n    }\n    listen(channelsNames) {\n        channelsNames.forEach((channelsName) => {\n            if (this.connection.state === 'connected') {\n                this.joinChannel(channelsName);\n            }\n            else {\n                this.subscribeChannel(channelsName);\n            }\n        });\n    }\n    stopListen(channelNames) {\n        channelNames.forEach((channelName) => {\n            const removedChannel = this.removeChannel(channelName);\n            if (removedChannel && this.connection.state === 'connected') {\n                removedChannel.leaveChannel();\n            }\n        });\n    }\n    subscribe(eventName, data, channel) {\n        return this.connection.bind(eventName, data, channel);\n    }\n    unsubscribe(eventName, data, channel) {\n        return this.connection.unbind(eventName, data, channel);\n    }\n    channel(channelName) {\n        return this.subscribeChannel(channelName);\n    }\n    addChannel(name, socket) {\n        if (!this.channels[name]) {\n            this.channels[name] = new _channel__WEBPACK_IMPORTED_MODULE_0__[\"default\"](name, socket);\n        }\n        return this.channels[name];\n    }\n    joinChannel(chanelName) {\n        this.addStorageChannel(chanelName);\n        return this.sendEvent(CONNECTION_EVENTS.JOIN, [chanelName]);\n    }\n    leaveChannel(chanelName) {\n        this.removeStorageChannel(chanelName);\n        return this.sendEvent(CONNECTION_EVENTS.LEAVE, [chanelName]);\n    }\n    findChannel(name) {\n        return this.channels[name];\n    }\n    removeChannel(name) {\n        const channel = this.channels[name];\n        delete this.channels[name];\n        return channel;\n    }\n    channelsDisconnect() {\n        Object.values(this.channels).forEach((channel) => channel.disconnect());\n    }\n    subscribeChannel(channelName) {\n        const channel = this.addChannel(channelName, this);\n        if (channel.subscriptionCancelled) {\n            channel.reinstateSubscription();\n        }\n        else if (this.connection.state === 'connected') {\n            channel.join();\n        }\n        return channel;\n    }\n    getStorage() {\n        if (this.hasStorage) {\n            const storageData = window.localStorage.getItem(STORAGE_KEY);\n            return storageData ? JSON.parse(storageData) : null;\n        }\n        return null;\n    }\n    addStorageChannel(channelName) {\n        if (this.hasStorage) {\n            const activeStorageChannels = this.getStorage();\n            if (activeStorageChannels) {\n                const activeChannels = activeStorageChannels.filter((channel) => channel !== channelName);\n                activeChannels.push(channelName);\n                this.setStorage(activeChannels);\n            }\n            else {\n                this.setStorage([channelName]);\n            }\n        }\n    }\n    removeStorageChannel(channelName) {\n        if (this.hasStorage) {\n            const activeStorage = this.getStorage();\n            if (activeStorage) {\n                const currentData = activeStorage.filter((channel) => channel !== channelName);\n                if (currentData.length) {\n                    this.setStorage(currentData);\n                }\n                else {\n                    this.clearStorage();\n                }\n            }\n        }\n    }\n    setStorage(args) {\n        if (this.hasStorage) {\n            return window.localStorage.setItem(STORAGE_KEY, JSON.stringify(args));\n        }\n        return null;\n    }\n    clearStorage() {\n        if (this.hasStorage) {\n            return window.localStorage.removeItem(STORAGE_KEY);\n        }\n        return null;\n    }\n}\nSFSocket.instances = [];\nSFSocket.isReady = false;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9saWIvc2ZTb2NrZXQudHM/MGYxNyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQWdDO0FBQ2tCO0FBQ0U7QUFFcEQsTUFBTSxXQUFXLEdBQUcsa0JBQWtCLENBQUM7QUFHdkMsTUFBTSxpQkFBaUIsR0FBRztJQUN4QixJQUFJLEVBQUUsTUFBTTtJQUNaLEtBQUssRUFBRSxPQUFPO0NBQ2YsQ0FBQztBQTRCRixNQUFNLGFBQWEsR0FBb0I7SUFDckMsSUFBSSxFQUFFLEVBQUU7SUFDUixJQUFJLEVBQUUsRUFBRTtJQUNSLE9BQU8sRUFBRSxHQUFHO0lBQ1osSUFBSSxFQUFFLEVBQUU7SUFDUixrQkFBa0IsRUFBRSxLQUFLO0lBQ3pCLE1BQU0sRUFBRSxLQUFLO0lBQ2IsVUFBVSxFQUFFLEtBQUs7Q0FDbEIsQ0FBQztBQUVLLE1BQU0sUUFBUTtJQXVCbkIsWUFBWSxPQUF5QjtRQUNuQyxJQUFJLENBQUMsT0FBTyxJQUFJLE9BQU8sT0FBTyxLQUFLLFFBQVEsRUFBRTtZQUMzQyxNQUFNLElBQUksS0FBSyxDQUFDLHNDQUFzQyxDQUFDLENBQUM7U0FDekQ7UUFFRCxNQUFNLGtCQUFrQixHQUFHLE9BQU8sSUFBSSxFQUFFLENBQUM7UUFFekMsSUFBSSxDQUFDLE1BQU0sR0FBRztZQUNaLEdBQUcsYUFBYTtZQUNoQixHQUFHLGtCQUFrQjtTQUN0QixDQUFDO1FBRUYsSUFBSSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7UUFDbkIsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUkseURBQWdCLEVBQUUsQ0FBQztRQUUvQyxJQUFJLENBQUMsVUFBVSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFVBQVUsSUFBSSxNQUFNLElBQUksTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBRW5GLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSwwREFBaUIsQ0FBQyxJQUFJLENBQUMsTUFBTSxD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QUMsT0FBZSxFQUFFLEVBQUUsQ0FBQyxPQUFPLEtBQUssV0FBVyxDQUFDLENBQUM7Z0JBRXZGLElBQUksV0FBVyxDQUFDLE1BQU0sRUFBRTtvQkFDdEIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMsQ0FBQztpQkFDOUI7cUJBQU07b0JBQ0wsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO2lCQUNyQjthQUNGO1NBQ0Y7SUFDSCxDQUFDO0lBRUQsVUFBVSxDQUFDLElBQWM7UUFDdkIsSUFBSSxJQUFJLENBQUMsVUFBVSxFQUFFO1lBQ25CLE9BQU8sTUFBTSxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztTQUN2RTtRQUVELE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVELFlBQVk7UUFDVixJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUU7WUFDbkIsT0FBTyxNQUFNLENBQUMsWUFBWSxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMsQ0FBQztTQUNwRDtRQUVELE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQzs7QUF4T00sa0JBQVMsR0FBZSxFQUFFLENBQUM7QUFFM0IsZ0JBQU8sR0FBWSxLQUFLLENBQUMiLCJmaWxlIjoiLi9saWIvc2ZTb2NrZXQudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ2hhbm5lbCBmcm9tICcuL2NoYW5uZWwnO1xuaW1wb3J0IEV2ZW50c0Rpc3BhdGNoZXIgZnJvbSAnLi9ldmVudHNEaXNwYXRjaGVyJztcbmltcG9ydCBDb25uZWN0aW9uTWFuYWdlciBmcm9tICcuL2Nvbm5lY3Rpb25NYW5hZ2VyJztcblxuY29uc3QgU1RPUkFHRV9LRVkgPSAnc2Zzb2NrZXRfc3RvcmFnZSc7XG5cblxuY29uc3QgQ09OTkVDVElPTl9FVkVOVFMgPSB7XG4gIEpPSU46ICdqb2luJyxcbiAgTEVBVkU6ICdsZWF2ZScsXG59O1xuXG5cbmV4cG9ydCBpbnRlcmZhY2UgSUNoYW5uZWxzIHtcbiAgW25hbWU6IHN0cmluZ106IENoYW5uZWw7XG59XG5cblxuZXhwb3J0IGludGVyZmFjZSBJU0ZTb2NrZXRDb25maWcge1xuICBob3N0OiBzdHJpbmcsXG4gIHBvcnQ6IHN0cmluZyB8IG51bWJlcjtcbiAgcG9ydFRMUz86IHN0cmluZyB8IG51bWJlcjtcbiAgcGF0aDogc3RyaW5nO1xuICB1bmF2YWlsYWJsZVRpbWVvdXQ/OiBudW1iZXI7XG4gIHVzZVRMUz86IGJvb2xlYW47XG4gIHVzZVN0b3JhZ2U/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElTRlNvY2tldEV2ZW50IHtcbiAgdHlwZTogc3RyaW5nLFxuICBkYXRhOiBzdHJpbmcgfCBudWxsLFxuICBlcnJvcjogc3RyaW5nIHwgbnVsbCxcbiAgY29udGV4dD86IHtcbiAgICBjaGFubmVsPzogc3RyaW5nLFxuICAgIGNvZGU/OiBzdHJpbmcgfCBudW1iZXIsXG4gIH0gfCBudWxsXG59XG5cbmNvbnN0IGRlZmF1bHRDb25maWc6IElTRlNvY2tldENvbmZpZyA9IHtcbiAgaG9zdDogJycsXG4gIHBvcnQ6IDgwLFxuICBwb3J0VExTOiA0NDMsXG4gIHBhdGg6ICcnLFxuICB1bmF2YWlsYWJsZVRpbWVvdXQ6IDEwMDAwLFxuICB1c2VUTFM6IGZhbHNlLFxuICB1c2VTdG9yYWdlOiBmYWxzZSxcbn07XG5cbmV4cG9ydCBjbGFzcyBTRlNvY2tldCB7XG4gIHN0YXRpYyBpbnN0YW5jZXM6IFNGU29ja2V0W10gPSBbXTtcblxuICBzdGF0aWMgaXNSZWFkeTogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIHN0YXRpYyByZWFkeSgpIHtcbiAgICBTRlNvY2tldC5pc1JlYWR5ID0gdHJ1ZTtcblxuICAgIFNGU29ja2V0Lmluc3RhbmNlcy5mb3JFYWNoKChpbnN0YW5jZSkgPT4ge1xuICAgICAgaW5zdGFuY2UuY29ubmVjdCgpO1xuICAgIH0pO1xuICB9XG5cbiAgY29uZmlnOiBJU0ZTb2NrZXRDb25maWc7XG5cbiAgY2hhbm5lbHM6IElDaGFubmVscztcblxuICBldmVudHNEaXNwYXRjaGVyOiBFdmVudHNEaXNwYXRjaGVyO1xuXG4gIGNvbm5lY3Rpb246IENvbm5lY3Rpb25NYW5hZ2VyO1xuXG4gIGhhc1N0b3JhZ2U6IGJvb2xlYW47XG5cbiAgY29uc3RydWN0b3Iob3B0aW9ucz86IElTRlNvY2tldENvbmZpZykge1xuICAgIGlmICghb3B0aW9ucyB8fCB0eXBlb2Ygb3B0aW9ucyAhPT0gJ29iamVjdCcpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignc2ZTb2NrZXQgb3B0aW9ucyBzaG91bGQgYmUgYW4gb2JqZWN0Jyk7XG4gICAgfVxuXG4gICAgY29uc3QgY29uc3RydWN0b3JPcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuICAgIHRoaXMuY29uZmlnID0ge1xuICAgICAgLi4uZGVmYXVsdENvbmZpZyxcbiAgICAgIC4uLmNvbnN0cnVjdG9yT3B0aW9ucyxcbiAgICB9O1xuXG4gICAgdGhpcy5jaGFubmVscyA9IHt9O1xuICAgIHRoaXMuZXZlbnRzRGlzcGF0Y2hlciA9IG5ldyBFdmVudHNEaXNwYXRjaGVyKCk7XG5cbiAgICB0aGlzLmhhc1N0b3JhZ2UgPSBCb29sZWFuKHRoaXMuY29uZmlnLnVzZVN0b3JhZ2UgJiYgd2luZG93ICYmIHdpbmRvdy5sb2NhbFN0b3JhZ2UpO1xuXG4gICAgdGhpcy5jb25uZWN0aW9uID0gbmV3IENvbm5lY3Rpb25NYW5hZ2VyKHRoaXMuY29uZmlnKTtcblxuICAgIHRoaXMuY29ubmVjdGlvbi5iaW5kKCdjb25uZWN0ZWQnLCAoKSA9PiB7XG4gICAgICBPYmplY3Qua2V5cyh0aGlzLmNoYW5uZWxzKS5mb3JFYWNoKChjaGFubmVsTmFtZSkgPT4ge1xuICAgICAgICB0aGlzLnN1YnNjcmliZUNoYW5uZWwoY2hhbm5lbE5hbWUpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLmNvbm5lY3Rpb24uYmluZCgnbWVzc2FnZScsIChldmVudDogYW55KSA9PiB7XG4gICAgICB0aGlzLmV2ZW50c0Rpc3BhdGNoZXIuZW1pdCgnbWVzc2FnZScsIGV2ZW50KTtcbiAgICB9KTtcblxuICAgIHRoaXMuY29ubmVjdGlvbi5iaW5kKCdjb25uZWN0aW5nJywgKCkgPT4ge1xuICAgICAgdGhpcy5jaGFubmVsc0Rpc2Nvbm5lY3QoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuY29ubmVjdGlvbi5iaW5kKCdkaXNjb25uZWN0ZWQnLCAoKSA9PiB7XG4gICAgICB0aGlzLmNoYW5uZWxzRGlzY29ubmVjdCgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5jb25uZWN0aW9uLmJpbmQoJ2Vycm9yJywgKGVycjogRXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgfSk7XG5cbiAgICBTRlNvY2tldC5pbnN0YW5jZXMucHVzaCh0aGlzKTtcblxuICAgIGlmIChTRlNvY2tldC5pc1JlYWR5KSB7XG4gICAgICB0aGlzLmNvbm5lY3QoKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5oYXNTdG9yYWdlKSB7XG4gICAgICBjb25zdCBhY3RpdmVDaGFubmVsczogc3RyaW5nW10gPSB0aGlzLmdldFN0b3JhZ2UoKTtcblxuICAgICAgaWYgKGFjdGl2ZUNoYW5uZWxzKSB7XG4gICAgICAgIGFjdGl2ZUNoYW5uZWxzLmZvckVhY2goKGNoYW5uZWxOYW1lKSA9PiB7XG4gICAgICAgICAgdGhpcy5zdWJzY3JpYmVDaGFubmVsKGNoYW5uZWxOYW1lKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgY29ubmVjdCgpIHtcbiAgICB0aGlzLmNvbm5lY3Rpb24uY29ubmVjdCgpO1xuICB9XG5cbiAgZGlzY29ubmVjdCgpIHtcbiAgICB0aGlzLmNvbm5lY3Rpb24uZGlzY29ubmVjdCgpO1xuICB9XG5cbiAgLy8gY29ubmVjdGlvbnNcbiAgc2VuZEV2ZW50KGV2ZW50TmFtZTogc3RyaW5nLCBkYXRhOiBzdHJpbmdbXSwgY2hhbm5lbD86IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLmNvbm5lY3Rpb24uc2VuZEV2ZW50KGV2ZW50TmFtZSwgZGF0YSwgY2hhbm5lbCk7XG4gIH1cblxuICBqb2luKGRhdGE6IHN0cmluZ1tdKSB7XG4gICAgcmV0dXJuIHRoaXMuc2VuZEV2ZW50KENPTk5FQ1RJT05fRVZFTlRTLkpPSU4sIGRhdGEpO1xuICB9XG5cbiAgbGVhdmUoZGF0YTogc3RyaW5nW10pIHtcbiAgICByZXR1cm4gdGhpcy5zZW5kRXZlbnQoQ09OTkVDVElPTl9FVkVOVFMuTEVBVkUsIGRhdGEpO1xuICB9XG5cbiAgbGlzdGVuKGNoYW5uZWxzTmFtZXM6IHN0cmluZ1tdKSB7XG4gICAgY2hhbm5lbHNOYW1lcy5mb3JFYWNoKChjaGFubmVsc05hbWUpID0+IHtcbiAgICAgIGlmICh0aGlzLmNvbm5lY3Rpb24uc3RhdGUgPT09ICdjb25uZWN0ZWQnKSB7XG4gICAgICAgIHRoaXMuam9pbkNoYW5uZWwoY2hhbm5lbHNOYW1lKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc3Vic2NyaWJlQ2hhbm5lbChjaGFubmVsc05hbWUpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgc3RvcExpc3RlbihjaGFubmVsTmFtZXM6IHN0cmluZ1tdKSB7XG4gICAgY2hhbm5lbE5hbWVzLmZvckVhY2goKGNoYW5uZWxOYW1lKSA9PiB7XG4gICAgICBjb25zdCByZW1vdmVkQ2hhbm5lbCA9IHRoaXMucmVtb3ZlQ2hhbm5lbChjaGFubmVsTmFtZSk7XG4gICAgICBpZiAocmVtb3ZlZENoYW5uZWwgJiYgdGhpcy5jb25uZWN0aW9uLnN0YXRlID09PSAnY29ubmVjdGVkJykge1xuICAgICAgICByZW1vdmVkQ2hhbm5lbC5sZWF2ZUNoYW5uZWwoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHN1YnNjcmliZShldmVudE5hbWU6IHN0cmluZywgZGF0YTogYW55LCBjaGFubmVsPzogc3RyaW5nKSB7IC8vIFRPRE9cbiAgICByZXR1cm4gdGhpcy5jb25uZWN0aW9uLmJpbmQoZXZlbnROYW1lLCBkYXRhLCBjaGFubmVsKTtcbiAgfVxuXG4gIHVuc3Vic2NyaWJlKGV2ZW50TmFtZTogc3RyaW5nLCBkYXRhOiBhbnksIGNoYW5uZWw/OiBzdHJpbmcpIHsgLy8gVE9ET1xuICAgIHJldHVybiB0aGlzLmNvbm5lY3Rpb24udW5iaW5kKGV2ZW50TmFtZSwgZGF0YSwgY2hhbm5lbCk7XG4gIH1cblxuICAvLyBjaGFubmVsc1xuICBjaGFubmVsKGNoYW5uZWxOYW1lOiBzdHJpbmcpOiBDaGFubmVsIHtcbiAgICByZXR1cm4gdGhpcy5zdWJzY3JpYmVDaGFubmVsKGNoYW5uZWxOYW1lKTtcbiAgfVxuXG4gIGFkZENoYW5uZWwobmFtZSA6IHN0cmluZywgc29ja2V0IDogU0ZTb2NrZXQpIHtcbiAgICBpZiAoIXRoaXMuY2hhbm5lbHNbbmFtZV0pIHtcbiAgICAgIHRoaXMuY2hhbm5lbHNbbmFtZV0gPSBuZXcgQ2hhbm5lbChuYW1lLCBzb2NrZXQpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5jaGFubmVsc1tuYW1lXTtcbiAgfVxuXG4gIGpvaW5DaGFubmVsKGNoYW5lbE5hbWU6IHN0cmluZykge1xuICAgIHRoaXMuYWRkU3RvcmFnZUNoYW5uZWwoY2hhbmVsTmFtZSk7XG4gICAgcmV0dXJuIHRoaXMuc2VuZEV2ZW50KENPTk5FQ1RJT05fRVZFTlRTLkpPSU4sIFtjaGFuZWxOYW1lXSk7XG4gIH1cblxuICBsZWF2ZUNoYW5uZWwoY2hhbmVsTmFtZTogc3RyaW5nKSB7XG4gICAgdGhpcy5yZW1vdmVTdG9yYWdlQ2hhbm5lbChjaGFuZWxOYW1lKTtcbiAgICByZXR1cm4gdGhpcy5zZW5kRXZlbnQoQ09OTkVDVElPTl9FVkVOVFMuTEVBVkUsIFtjaGFuZWxOYW1lXSk7XG4gIH1cblxuICBmaW5kQ2hhbm5lbChuYW1lOiBzdHJpbmcpOiBDaGFubmVsIHtcbiAgICByZXR1cm4gdGhpcy5jaGFubmVsc1tuYW1lXTtcbiAgfVxuXG4gIHByaXZhdGUgcmVtb3ZlQ2hhbm5lbChuYW1lIDogc3RyaW5nKSB7XG4gICAgY29uc3QgY2hhbm5lbCA9IHRoaXMuY2hhbm5lbHNbbmFtZV07XG4gICAgZGVsZXRlIHRoaXMuY2hhbm5lbHNbbmFtZV07XG4gICAgcmV0dXJuIGNoYW5uZWw7XG4gIH1cblxuICBwcml2YXRlIGNoYW5uZWxzRGlzY29ubmVjdCgpIHtcbiAgICBPYmplY3QudmFsdWVzKHRoaXMuY2hhbm5lbHMpLmZvckVhY2goKGNoYW5uZWw6IENoYW5uZWwpID0+IGNoYW5uZWwuZGlzY29ubmVjdCgpKTtcbiAgfVxuXG4gIHByaXZhdGUgc3Vic2NyaWJlQ2hhbm5lbChjaGFubmVsTmFtZTogc3RyaW5nKSB7XG4gICAgY29uc3QgY2hhbm5lbCA9IHRoaXMuYWRkQ2hhbm5lbChjaGFubmVsTmFtZSwgdGhpcyk7XG5cbiAgICBpZiAoY2hhbm5lbC5zdWJzY3JpcHRpb25DYW5jZWxsZWQpIHtcbiAgICAgIGNoYW5uZWwucmVpbnN0YXRlU3Vic2NyaXB0aW9uKCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmNvbm5lY3Rpb24uc3RhdGUgPT09ICdjb25uZWN0ZWQnKSB7XG4gICAgICBjaGFubmVsLmpvaW4oKTtcbiAgICB9XG4gICAgcmV0dXJuIGNoYW5uZWw7XG4gIH1cblxuICAvLyBzdG9yYWdlXG4gIGdldFN0b3JhZ2UoKSB7XG4gICAgaWYgKHRoaXMuaGFzU3RvcmFnZSkge1xuICAgICAgY29uc3Qgc3RvcmFnZURhdGEgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oU1RPUkFHRV9LRVkpO1xuXG4gICAgICByZXR1cm4gc3RvcmFnZURhdGEgPyBKU09OLnBhcnNlKHN0b3JhZ2VEYXRhKSA6IG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBhZGRTdG9yYWdlQ2hhbm5lbChjaGFubmVsTmFtZTogc3RyaW5nKSB7XG4gICAgaWYgKHRoaXMuaGFzU3RvcmFnZSkge1xuICAgICAgY29uc3QgYWN0aXZlU3RvcmFnZUNoYW5uZWxzID0gdGhpcy5nZXRTdG9yYWdlKCk7XG5cbiAgICAgIGlmIChhY3RpdmVTdG9yYWdlQ2hhbm5lbHMpIHsgLy8gcmVtb3ZlIG9sZGVyIHJlY29yZHNcbiAgICAgICAgY29uc3QgYWN0aXZlQ2hhbm5lbHMgPSBhY3RpdmVTdG9yYWdlQ2hhbm5lbHMuZmlsdGVyKChjaGFubmVsOiBzdHJpbmcpID0+IGNoYW5uZWwgIT09IGNoYW5uZWxOYW1lKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBtYXgtbGVuXG5cbiAgICAgICAgYWN0aXZlQ2hhbm5lbHMucHVzaChjaGFubmVsTmFtZSk7XG5cbiAgICAgICAgdGhpcy5zZXRTdG9yYWdlKGFjdGl2ZUNoYW5uZWxzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc2V0U3RvcmFnZShbY2hhbm5lbE5hbWVdKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZW1vdmVTdG9yYWdlQ2hhbm5lbChjaGFubmVsTmFtZTogc3RyaW5nKSB7XG4gICAgaWYgKHRoaXMuaGFzU3RvcmFnZSkge1xuICAgICAgY29uc3QgYWN0aXZlU3RvcmFnZSA9IHRoaXMuZ2V0U3RvcmFnZSgpO1xuXG4gICAgICBpZiAoYWN0aXZlU3RvcmFnZSkge1xuICAgICAgICBjb25zdCBjdXJyZW50RGF0YSA9IGFjdGl2ZVN0b3JhZ2UuZmlsdGVyKChjaGFubmVsOiBzdHJpbmcpID0+IGNoYW5uZWwgIT09IGNoYW5uZWxOYW1lKTtcblxuICAgICAgICBpZiAoY3VycmVudERhdGEubGVuZ3RoKSB7XG4gICAgICAgICAgdGhpcy5zZXRTdG9yYWdlKGN1cnJlbnREYXRhKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmNsZWFyU3RvcmFnZSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgc2V0U3RvcmFnZShhcmdzOiBzdHJpbmdbXSkge1xuICAgIGlmICh0aGlzLmhhc1N0b3JhZ2UpIHtcbiAgICAgIHJldHVybiB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oU1RPUkFHRV9LRVksIEpTT04uc3RyaW5naWZ5KGFyZ3MpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGNsZWFyU3RvcmFnZSgpIHtcbiAgICBpZiAodGhpcy5oYXNTdG9yYWdlKSB7XG4gICAgICByZXR1cm4gd2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFNUT1JBR0VfS0VZKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./lib/sfSocket.ts\n");

/***/ }),

/***/ "./lib/transport.ts":
/*!**************************!*\
  !*** ./lib/transport.ts ***!
  \**************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Transport; });\n/* harmony import */ var _connection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./connection */ \"./lib/connection.ts\");\n/* harmony import */ var _transportConnection__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./transportConnection */ \"./lib/transportConnection.ts\");\n\n\nclass Transport {\n    constructor(name, options) {\n        this.options = options || {};\n        const scheme = `ws${options.useTLS ? 's' : ''}`;\n        const host = options.useTLS ? (`${options.host}:${options.portTLS}`) : (`${options.host}:${options.port}`);\n        const url = `${scheme}://${host}/${options.path}`;\n        this.hooks = {\n            url,\n            isInitialized() {\n                return Boolean(window.WebSocket);\n            },\n            getSocket(socketUrl) {\n                const Constructor = window.WebSocket;\n                return new Constructor(socketUrl);\n            },\n        };\n        this.name = name;\n    }\n    connect(callback) {\n        let connected = false;\n        const transport = new _transportConnection__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.hooks, this.name);\n        const onInitialized = () => {\n            transport.unbind('initialized', onInitialized);\n            transport.connect();\n        };\n        const unbindListeners = () => {\n            transport.unbind('initialized', onInitialized);\n            transport.unbind('open', onOpen);\n            transport.unbind('error', onError);\n            transport.unbind('closed', onClosed);\n        };\n        const onOpen = () => {\n            connected = true;\n            unbindListeners();\n            const result = new _connection__WEBPACK_IMPORTED_MODULE_0__[\"default\"]('', transport);\n            callback(null, result);\n        };\n        const onError = (error) => {\n            unbindListeners();\n            callback(error);\n        };\n        const onClosed = () => {\n            unbindListeners();\n        };\n        transport.bind('initialized', onInitialized);\n        transport.bind('open', onOpen);\n        transport.bind('error', onError);\n        transport.bind('closed', onClosed);\n        transport.initialize();\n        return {\n            abort: () => {\n                if (connected) {\n                    return;\n                }\n                unbindListeners();\n                transport.close();\n            },\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9saWIvdHJhbnNwb3J0LnRzPzBjMWEiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBc0M7QUFDc0M7QUFXN0QsTUFBTSxTQUFTO0lBTzVCLFlBQVksSUFBWSxFQUFFLE9BQXdCO1FBQ2hELElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxJQUFJLEVBQUUsQ0FBQztRQUU3QixNQUFNLE1BQU0sR0FBRyxLQUFLLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDaEQsTUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxJQUFJLElBQUksT0FBTyxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxPQUFPLENBQUMsSUFBSSxJQUFJLE9BQU8sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO1FBRTNHLE1BQU0sR0FBRyxHQUFHLEdBQUcsTUFBTSxNQUFNLElBQUksSUFBSSxPQUFPLENBQUMsSUFBSSxFQUFFLENBQUM7UUFFbEQsSUFBSSxDQUFDLEtBQUssR0FBRztZQUNYLEdBQUc7WUFDSCxhQUFhO2dCQUNYLE9BQU8sT0FBTyxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQTZCLENBQUM7WUFDL0QsQ0FBQztZQUNELFNBQVMsQ0FBQyxTQUFTO2dCQUNqQixNQUFNLFdBQVcsR0FBRyxNQUFNLENBQUMsU0FBUyxDQUE2QjtnQkFDakUsT0FBTyxJQUFJLFdBQVcsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUNwQyxDQUFDO1NBQ0YsQ0FBQztRQUNGLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO0lBQ25CLENBQUM7SUFFRCxPQUFPLENBQUMsUUFBa0I7UUFDeEIsSUFBSSxTQUFTLEdBQUcsS0FBSyxDQUFDO1FBRXRCLE1BQU0sU0FBUyxHQUFHLElBQUksNERBQW1CLENBQ3ZDLElBQUksQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FDdEIsQ0FBQztRQUVGLE1BQU0sYUFBYSxHQUFHLEdBQUcsRUFBRTtZQUN6QixTQUFTLENBQUMsTUFBTSxDQUFDLGFBQWEsRUFBRSxhQUFhLENBQUMsQ0FBQztZQUMvQyxTQUFTLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDdEIsQ0FBQyxDQUFDO1FBRUYsTUFBTSxlQUFlLEdBQUcsR0FBRyxFQUFFO1lBQzNCLFNBQVMsQ0FBQyxNQUFNLENBQUMsYUFBYSxFQUFFLGFBQWEsQ0FBQyxDQUFDO1lBQy9DLFNBQVMsQ0FBQyxNQUFNLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1lBQ2pDLFNBQVMsQ0FBQyxNQUFNLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1lBQ25DLFNBQVMsQ0FBQyxNQUFNLENBQUMsUUFBUSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1FBQ3ZDLENBQUMsQ0FBQztRQUVGLE1BQU0sTUFBTSxHQUFHLEdBQUcsRUFBRTtZQUNsQixTQUFTLEdBQUcsSUFBSSxDQUFDO1lBQ2pCLGVBQWUsRUFBRSxDQUFDO1lBQ2xCLE1BQU0sTUFBTSxHQUFHLElBQUksbURBQVUsQ0FBQyxFQUFFLEVBQUUsU0FBUyxDQUFDLENBQUM7WUFDN0MsUUFBUSxDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsQ0FBQztRQUN6QixDQUFDLENBQUM7UUFFRixNQUFNLE9BQU8sR0FBRyxDQUFDLEtBQVUsRUFBRSxFQUFFO1lBQzdCLGVBQWUsRUFBRSxDQUFDO1lBQ2xCLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNsQixDQUFDLENBQUM7UUFDRixNQUFNLFFBQVEsR0FBRyxHQUFHLEVBQUU7WUFDcEIsZUFBZSxFQUFFLENBQUM7UUFDcEIsQ0FBQyxDQUFDO1FBRUYsU0FBUyxDQUFDLElBQUksQ0FBQyxhQUFhLEVBQUUsYUFBYSxDQUFDLENBQUM7UUFDN0MsU0FBUyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDL0IsU0FBUyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDakMsU0FBUyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFFbkMsU0FBUyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBRXZCLE9BQU87WUFDTCxLQUFLLEVBQUUsR0FBRyxFQUFFO2dCQUNWLElBQUksU0FBUyxFQUFFO29CQUNiLE9BQU87aUJBQ1I7Z0JBQ0QsZUFBZSxFQUFFLENBQUM7Z0JBQ2xCLFNBQVMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUNwQixDQUFDO1NBQ0YsQ0FBQztJQUNKLENBQUM7Q0FDRiIsImZpbGUiOiIuL2xpYi90cmFuc3BvcnQudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ29ubmVjdGlvbiBmcm9tICcuL2Nvbm5lY3Rpb24nO1xuaW1wb3J0IFRyYW5zcG9ydENvbm5lY3Rpb24sIHsgVHJhbnNwb3J0SG9va3MgfSBmcm9tICcuL3RyYW5zcG9ydENvbm5lY3Rpb24nO1xuaW1wb3J0IHsgSVNGU29ja2V0Q29uZmlnIH0gZnJvbSAnLi9zZlNvY2tldCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVJ1bm5lciB7XG4gIGFib3J0OiAoKSA9PiB2b2lkO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElUcmFuc3BvcnQge1xuICBjb25uZWN0KGNhbGxiYWNrOiBGdW5jdGlvbik6IElSdW5uZXI7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRyYW5zcG9ydCBpbXBsZW1lbnRzIElUcmFuc3BvcnQge1xuICBob29rczogVHJhbnNwb3J0SG9va3M7XG5cbiAgbmFtZTogc3RyaW5nO1xuXG4gIG9wdGlvbnM6IElTRlNvY2tldENvbmZpZztcblxuICBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcsIG9wdGlvbnM6IElTRlNvY2tldENvbmZpZykge1xuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cbiAgICBjb25zdCBzY2hlbWUgPSBgd3Mke29wdGlvbnMudXNlVExTID8gJ3MnIDogJyd9YDtcbiAgICBjb25zdCBob3N0ID0gb3B0aW9ucy51c2VUTFMgPyAoYCR7b3B0aW9ucy5ob3N0fToke29wdGlvbnMucG9ydFRMU31gKSA6IChgJHtvcHRpb25zLmhvc3R9OiR7b3B0aW9ucy5wb3J0fWApO1xuXG4gICAgY29uc3QgdXJsID0gYCR7c2NoZW1lfTovLyR7aG9zdH0vJHtvcHRpb25zLnBhdGh9YDtcblxuICAgIHRoaXMuaG9va3MgPSB7XG4gICAgICB1cmwsXG4gICAgICBpc0luaXRpYWxpemVkKCkge1xuICAgICAgICByZXR1cm4gQm9vbGVhbih3aW5kb3cuV2ViU29ja2V0LyogfHwgd2luZG93Lk1veldlYlNvY2tldCAqLyk7XG4gICAgICB9LFxuICAgICAgZ2V0U29ja2V0KHNvY2tldFVybCkge1xuICAgICAgICBjb25zdCBDb25zdHJ1Y3RvciA9IHdpbmRvdy5XZWJTb2NrZXQvKiB8fCB3aW5kb3cuTW96V2ViU29ja2V0ICovO1xuICAgICAgICByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHNvY2tldFVybCk7XG4gICAgICB9LFxuICAgIH07XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgfVxuXG4gIGNvbm5lY3QoY2FsbGJhY2s6IEZ1bmN0aW9uKSB7XG4gICAgbGV0IGNvbm5lY3RlZCA9IGZhbHNlO1xuXG4gICAgY29uc3QgdHJhbnNwb3J0ID0gbmV3IFRyYW5zcG9ydENvbm5lY3Rpb24oXG4gICAgICB0aGlzLmhvb2tzLCB0aGlzLm5hbWUsXG4gICAgKTtcblxuICAgIGNvbnN0IG9uSW5pdGlhbGl6ZWQgPSAoKSA9PiB7XG4gICAgICB0cmFuc3BvcnQudW5iaW5kKCdpbml0aWFsaXplZCcsIG9uSW5pdGlhbGl6ZWQpO1xuICAgICAgdHJhbnNwb3J0LmNvbm5lY3QoKTtcbiAgICB9O1xuXG4gICAgY29uc3QgdW5iaW5kTGlzdGVuZXJzID0gKCkgPT4ge1xuICAgICAgdHJhbnNwb3J0LnVuYmluZCgnaW5pdGlhbGl6ZWQnLCBvbkluaXRpYWxpemVkKTtcbiAgICAgIHRyYW5zcG9ydC51bmJpbmQoJ29wZW4nLCBvbk9wZW4pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVzZS1iZWZvcmUtZGVmaW5lXG4gICAgICB0cmFuc3BvcnQudW5iaW5kKCdlcnJvcicsIG9uRXJyb3IpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVzZS1iZWZvcmUtZGVmaW5lXG4gICAgICB0cmFuc3BvcnQudW5iaW5kKCdjbG9zZWQnLCBvbkNsb3NlZCk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdXNlLWJlZm9yZS1kZWZpbmVcbiAgICB9O1xuXG4gICAgY29uc3Qgb25PcGVuID0gKCkgPT4ge1xuICAgICAgY29ubmVjdGVkID0gdHJ1ZTtcbiAgICAgIHVuYmluZExpc3RlbmVycygpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IENvbm5lY3Rpb24oJycsIHRyYW5zcG9ydCk7XG4gICAgICBjYWxsYmFjayhudWxsLCByZXN1bHQpO1xuICAgIH07XG5cbiAgICBjb25zdCBvbkVycm9yID0gKGVycm9yOiBhbnkpID0+IHsgLy8gVE9ET1xuICAgICAgdW5iaW5kTGlzdGVuZXJzKCk7XG4gICAgICBjYWxsYmFjayhlcnJvcik7XG4gICAgfTtcbiAgICBjb25zdCBvbkNsb3NlZCA9ICgpID0+IHtcbiAgICAgIHVuYmluZExpc3RlbmVycygpO1xuICAgIH07XG5cbiAgICB0cmFuc3BvcnQuYmluZCgnaW5pdGlhbGl6ZWQnLCBvbkluaXRpYWxpemVkKTtcbiAgICB0cmFuc3BvcnQuYmluZCgnb3BlbicsIG9uT3Blbik7XG4gICAgdHJhbnNwb3J0LmJpbmQoJ2Vycm9yJywgb25FcnJvcik7XG4gICAgdHJhbnNwb3J0LmJpbmQoJ2Nsb3NlZCcsIG9uQ2xvc2VkKTtcblxuICAgIHRyYW5zcG9ydC5pbml0aWFsaXplKCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgYWJvcnQ6ICgpID0+IHtcbiAgICAgICAgaWYgKGNvbm5lY3RlZCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB1bmJpbmRMaXN0ZW5lcnMoKTtcbiAgICAgICAgdHJhbnNwb3J0LmNsb3NlKCk7XG4gICAgICB9LFxuICAgIH07XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./lib/transport.ts\n");

/***/ }),

/***/ "./lib/transportConnection.ts":
/*!************************************!*\
  !*** ./lib/transportConnection.ts ***!
  \************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return TransportConnection; });\n/* harmony import */ var _eventsDispatcher__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./eventsDispatcher */ \"./lib/eventsDispatcher.ts\");\n\nclass TransportConnection extends _eventsDispatcher__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\n    constructor(hooks, name) {\n        super();\n        this.initialize = () => {\n            const self = this;\n            if (self.hooks.isInitialized()) {\n                self.changeState('initialized');\n            }\n            else {\n                self.onClose();\n            }\n        };\n        this.hooks = hooks;\n        this.name = name;\n        this.state = 'new';\n    }\n    connect() {\n        if (this.socket || this.state !== 'initialized') {\n            return false;\n        }\n        const { url } = this.hooks;\n        try {\n            this.socket = this.hooks.getSocket(url);\n        }\n        catch (e) {\n            setTimeout(() => {\n                this.onError(e);\n                this.changeState('closed');\n            });\n            return false;\n        }\n        this.bindListeners();\n        this.changeState('connecting');\n        return true;\n    }\n    close() {\n        if (this.socket) {\n            this.socket.close();\n            return true;\n        }\n        return false;\n    }\n    send(data) {\n        if (this.state === 'open') {\n            setTimeout(() => {\n                if (this.socket) {\n                    this.socket.send(data);\n                }\n            });\n            return true;\n        }\n        return false;\n    }\n    unbindListeners() {\n        if (!this.socket)\n            return;\n        this.socket.onopen = null;\n        this.socket.onerror = null;\n        this.socket.onclose = null;\n        this.socket.onmessage = null;\n    }\n    onOpen() {\n        this.changeState('open');\n        if (!this.socket)\n            return;\n        this.socket.onopen = null;\n    }\n    onError(error) {\n        this.emit('error', {\n            type: 'sfSocket:error',\n            error: error || 'websocket connection error',\n            data: null,\n        });\n    }\n    onClose(closeEvent) {\n        if (closeEvent) {\n            this.changeState('closed', {\n                type: closeEvent.wasClean ? 'sfSocket:closed' : 'sfSocket:error',\n                data: closeEvent.wasClean ? closeEvent.reason : null,\n                error: closeEvent.wasClean ? null : closeEvent.reason,\n                context: {\n                    code: closeEvent.code,\n                },\n            });\n        }\n        else {\n            this.changeState('closed');\n        }\n        this.unbindListeners();\n        this.socket = undefined;\n    }\n    onMessage(message) {\n        this.emit('message', {\n            type: 'sfSocket:message',\n            data: typeof message.data === 'string' ? message.data : JSON.stringify(message.data),\n            error: null,\n        });\n    }\n    bindListeners() {\n        if (!this.socket)\n            return;\n        this.socket.onopen = () => {\n            this.onOpen();\n        };\n        this.socket.onerror = () => {\n            this.onError();\n        };\n        this.socket.onclose = (closeEvent) => {\n            this.onClose(closeEvent);\n        };\n        this.socket.onmessage = (message) => {\n            this.onMessage(message);\n        };\n    }\n    changeState(state, params) {\n        this.state = state;\n        this.emit(state, params);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9saWIvdHJhbnNwb3J0Q29ubmVjdGlvbi50cz8yYTEyIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFrRDtBQVNuQyxNQUFNLG1CQUFvQixTQUFRLHlEQUFnQjtJQVcvRCxZQUFZLEtBQXNCLEVBQUUsSUFBYTtRQUMvQyxLQUFLLEVBQUUsQ0FBQztRQUNSLElBQUksQ0FBQyxVQUFVLEdBQUcsR0FBRyxFQUFFO1lBQ3JCLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQztZQUVsQixJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsYUFBYSxFQUFFLEVBQUU7Z0JBQzlCLElBQUksQ0FBQyxXQUFXLENBQUMsYUFBYSxDQUFDLENBQUM7YUFDakM7aUJBQU07Z0JBQ0wsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO2FBQ2hCO1FBQ0gsQ0FBQyxDQUFDO1FBQ0YsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7UUFDbkIsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7UUFFakIsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7SUFDckIsQ0FBQztJQUVELE9BQU87UUFDTCxJQUFJLElBQUksQ0FBQyxNQUFNLElBQUksSUFBSSxDQUFDLEtBQUssS0FBSyxhQUFhLEVBQUU7WUFDL0MsT0FBTyxLQUFLLENBQUM7U0FDZDtRQUVELE1BQU0sRUFBRSxHQUFHLEVBQUUsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO1FBQzNCLElBQUk7WUFDRixJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQ3pDO1FBQUMsT0FBTyxDQUFDLEVBQUU7WUFFVixVQUFVLENBQUMsR0FBRyxFQUFFO2dCQUNkLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ2hCLElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDN0IsQ0FB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QUksQ0FBQztZQUNwRixLQUFLLEVBQUUsSUFBSTtTQUNaLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFTyxhQUFhO1FBQ25CLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTTtZQUFFLE9BQU87UUFDekIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEdBQUcsR0FBRyxFQUFFO1lBQ3hCLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNoQixDQUFDLENBQUM7UUFDRixJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sR0FBRyxHQUFHLEVBQUU7WUFDekIsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ2pCLENBQUMsQ0FBQztRQUNGLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxHQUFHLENBQUMsVUFBc0IsRUFBRSxFQUFFO1lBQy9DLElBQUksQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDM0IsQ0FBQyxDQUFDO1FBQ0YsSUFBSSxDQUFDLE1BQU0sQ0FBQyxTQUFTLEdBQUcsQ0FBQyxPQUFxQixFQUFFLEVBQUU7WUFDaEQsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUMxQixDQUFDLENBQUM7SUFDSixDQUFDO0lBRU8sV0FBVyxDQUFDLEtBQWMsRUFBRSxNQUF1QjtRQUN6RCxJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztRQUNuQixJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztJQUMzQixDQUFDO0NBQ0YiLCJmaWxlIjoiLi9saWIvdHJhbnNwb3J0Q29ubmVjdGlvbi50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBFdmVudHNEaXNwYXRjaGVyIGZyb20gJy4vZXZlbnRzRGlzcGF0Y2hlcic7XG5pbXBvcnQgeyBJU0ZTb2NrZXRDb25maWcsIElTRlNvY2tldEV2ZW50IH0gZnJvbSAnLi9zZlNvY2tldCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgVHJhbnNwb3J0SG9va3Mge1xuICB1cmw6IHN0cmluZztcbiAgaXNJbml0aWFsaXplZCgpOiBib29sZWFuO1xuICBnZXRTb2NrZXQodXJsOiBzdHJpbmcsIG9wdGlvbnM/OiBJU0ZTb2NrZXRDb25maWcpOiBXZWJTb2NrZXQ7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRyYW5zcG9ydENvbm5lY3Rpb24gZXh0ZW5kcyBFdmVudHNEaXNwYXRjaGVyIHtcbiAgaG9va3M6IFRyYW5zcG9ydEhvb2tzO1xuXG4gIG5hbWU6IHN0cmluZztcblxuICBzdGF0ZTogc3RyaW5nO1xuXG4gIHNvY2tldD86IFdlYlNvY2tldDtcblxuICBpbml0aWFsaXplOiBGdW5jdGlvbjtcblxuICBjb25zdHJ1Y3Rvcihob29rcyA6IFRyYW5zcG9ydEhvb2tzLCBuYW1lIDogc3RyaW5nKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLmluaXRpYWxpemUgPSAoKSA9PiB7XG4gICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgaWYgKHNlbGYuaG9va3MuaXNJbml0aWFsaXplZCgpKSB7XG4gICAgICAgIHNlbGYuY2hhbmdlU3RhdGUoJ2luaXRpYWxpemVkJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZWxmLm9uQ2xvc2UoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMuaG9va3MgPSBob29rcztcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuXG4gICAgdGhpcy5zdGF0ZSA9ICduZXcnO1xuICB9XG5cbiAgY29ubmVjdCgpIDogYm9vbGVhbiB7XG4gICAgaWYgKHRoaXMuc29ja2V0IHx8IHRoaXMuc3RhdGUgIT09ICdpbml0aWFsaXplZCcpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBjb25zdCB7IHVybCB9ID0gdGhpcy5ob29rcztcbiAgICB0cnkge1xuICAgICAgdGhpcy5zb2NrZXQgPSB0aGlzLmhvb2tzLmdldFNvY2tldCh1cmwpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIC8vIFdvcmthcm91bmQgZm9yIE1vYmlsZVNhZmFyaSBidWcgKHNlZSBodHRwczovL2dpc3QuZ2l0aHViLmNvbS8yMDUyMDA2KVxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHRoaXMub25FcnJvcihlKTtcbiAgICAgICAgdGhpcy5jaGFuZ2VTdGF0ZSgnY2xvc2VkJyk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB0aGlzLmJpbmRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLmNoYW5nZVN0YXRlKCdjb25uZWN0aW5nJyk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvKiogQ2xvc2VzIHRoZSBjb25uZWN0aW9uLlxuICAgKlxuICAgKiBAcmV0dXJuIHtCb29sZWFufSB0cnVlIGlmIHRoZXJlIHdhcyBhIGNvbm5lY3Rpb24gdG8gY2xvc2VcbiAgICovXG4gIGNsb3NlKCkgOiBib29sZWFuIHtcbiAgICBpZiAodGhpcy5zb2NrZXQpIHtcbiAgICAgIHRoaXMuc29ja2V0LmNsb3NlKCk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgc2VuZChkYXRhIDogYW55KSA6IGJvb2xlYW4geyAvLyBUT0RPXG4gICAgaWYgKHRoaXMuc3RhdGUgPT09ICdvcGVuJykge1xuICAgICAgLy8gV29ya2Fyb3VuZCBmb3IgTW9iaWxlU2FmYXJpIGJ1ZyAoc2VlIGh0dHBzOi8vZ2lzdC5naXRodWIuY29tLzIwNTIwMDYpXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuc29ja2V0KSB7XG4gICAgICAgICAgdGhpcy5zb2NrZXQuc2VuZChkYXRhKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcHJpdmF0ZSB1bmJpbmRMaXN0ZW5lcnMoKSB7XG4gICAgaWYgKCF0aGlzLnNvY2tldCkgcmV0dXJuO1xuICAgIHRoaXMuc29ja2V0Lm9ub3BlbiA9IG51bGw7XG4gICAgdGhpcy5zb2NrZXQub25lcnJvciA9IG51bGw7XG4gICAgdGhpcy5zb2NrZXQub25jbG9zZSA9IG51bGw7XG4gICAgdGhpcy5zb2NrZXQub25tZXNzYWdlID0gbnVsbDtcbiAgfVxuXG5cbiAgcHJpdmF0ZSBvbk9wZW4oKSB7XG4gICAgdGhpcy5jaGFuZ2VTdGF0ZSgnb3BlbicpO1xuICAgIGlmICghdGhpcy5zb2NrZXQpIHJldHVybjtcbiAgICB0aGlzLnNvY2tldC5vbm9wZW4gPSBudWxsO1xuICB9XG5cbiAgcHJpdmF0ZSBvbkVycm9yKGVycm9yPzogc3RyaW5nKSB7XG4gICAgdGhpcy5lbWl0KCdlcnJvcicsIHtcbiAgICAgIHR5cGU6ICdzZlNvY2tldDplcnJvcicsXG4gICAgICBlcnJvcjogZXJyb3IgfHwgJ3dlYnNvY2tldCBjb25uZWN0aW9uIGVycm9yJyxcbiAgICAgIGRhdGE6IG51bGwsXG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIG9uQ2xvc2UoY2xvc2VFdmVudD86IENsb3NlRXZlbnQpIHtcbiAgICBpZiAoY2xvc2VFdmVudCkge1xuICAgICAgdGhpcy5jaGFuZ2VTdGF0ZSgnY2xvc2VkJywge1xuICAgICAgICB0eXBlOiBjbG9zZUV2ZW50Lndhc0NsZWFuID8gJ3NmU29ja2V0OmNsb3NlZCcgOiAnc2ZTb2NrZXQ6ZXJyb3InLFxuICAgICAgICBkYXRhOiBjbG9zZUV2ZW50Lndhc0NsZWFuID8gY2xvc2VFdmVudC5yZWFzb24gOiBudWxsLFxuICAgICAgICBlcnJvcjogY2xvc2VFdmVudC53YXNDbGVhbiA/IG51bGwgOiBjbG9zZUV2ZW50LnJlYXNvbixcbiAgICAgICAgY29udGV4dDoge1xuICAgICAgICAgIGNvZGU6IGNsb3NlRXZlbnQuY29kZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNoYW5nZVN0YXRlKCdjbG9zZWQnKTtcbiAgICB9XG4gICAgdGhpcy51bmJpbmRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLnNvY2tldCA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIHByaXZhdGUgb25NZXNzYWdlKG1lc3NhZ2U6IE1lc3NhZ2VFdmVudCkge1xuICAgIHRoaXMuZW1pdCgnbWVzc2FnZScsIHtcbiAgICAgIHR5cGU6ICdzZlNvY2tldDptZXNzYWdlJyxcbiAgICAgIGRhdGE6IHR5cGVvZiBtZXNzYWdlLmRhdGEgPT09ICdzdHJpbmcnID8gbWVzc2FnZS5kYXRhIDogSlNPTi5zdHJpbmdpZnkobWVzc2FnZS5kYXRhKSxcbiAgICAgIGVycm9yOiBudWxsLFxuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBiaW5kTGlzdGVuZXJzKCkge1xuICAgIGlmICghdGhpcy5zb2NrZXQpIHJldHVybjtcbiAgICB0aGlzLnNvY2tldC5vbm9wZW4gPSAoKSA9PiB7XG4gICAgICB0aGlzLm9uT3BlbigpO1xuICAgIH07XG4gICAgdGhpcy5zb2NrZXQub25lcnJvciA9ICgpID0+IHtcbiAgICAgIHRoaXMub25FcnJvcigpO1xuICAgIH07XG4gICAgdGhpcy5zb2NrZXQub25jbG9zZSA9IChjbG9zZUV2ZW50OiBDbG9zZUV2ZW50KSA9PiB7XG4gICAgICB0aGlzLm9uQ2xvc2UoY2xvc2VFdmVudCk7XG4gICAgfTtcbiAgICB0aGlzLnNvY2tldC5vbm1lc3NhZ2UgPSAobWVzc2FnZTogTWVzc2FnZUV2ZW50KSA9PiB7XG4gICAgICB0aGlzLm9uTWVzc2FnZShtZXNzYWdlKTtcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBjaGFuZ2VTdGF0ZShzdGF0ZSA6IHN0cmluZywgcGFyYW1zPzogSVNGU29ja2V0RXZlbnQpIHtcbiAgICB0aGlzLnN0YXRlID0gc3RhdGU7XG4gICAgdGhpcy5lbWl0KHN0YXRlLCBwYXJhbXMpO1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./lib/transportConnection.ts\n");

/***/ })

/******/ });